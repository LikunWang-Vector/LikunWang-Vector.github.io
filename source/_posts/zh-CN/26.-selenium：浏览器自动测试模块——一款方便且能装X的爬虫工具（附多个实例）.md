---
title: "26. seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½è£…Xçš„çˆ¬è™«å·¥å…·ï¼ˆé™„å¤šä¸ªå®ä¾‹ï¼‰"
date: 2023-01-16
updated: 2023-01-16
categories:
  - Pythonçˆ¬è™«å…¥é—¨ã€è¿›é˜¶ä¸å®æˆ˜
tags:
  - çˆ¬è™«
  - selenium
  - æµ‹è¯•å·¥å…·
  - æ•°æ®åˆ†æ
  - chrome
csdn_views: 2165
csdn_likes: 10
csdn_comments: 3
csdn_favorites: 21
csdn_url: https://blog.csdn.net/m0_59180666/article/details/128699574
cover: /images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/89eaa3af64c6.png
lang_pair:
  en: "26. Selenium: Browser Automation Testing Module - A Convenient Scraping Tool (Multiple Examples)"
---

> æœ¬æ–‡è¿ç§»è‡ªCSDNåšå®¢
> åŸæ–‡é“¾æ¥ï¼š[26. seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½è£…Xçš„çˆ¬è™«å·¥å…·ï¼ˆé™„å¤šä¸ªå®ä¾‹ï¼‰](https://blog.csdn.net/m0_59180666/article/details/128699574)
> ğŸ“Š 2165 é˜…è¯» | ğŸ‘ 10 ç‚¹èµ | ğŸ’¬ 3 è¯„è®º | â­ 21 æ”¶è—

**ç›®å½•**

å‰è¨€

ä»€ä¹ˆæ˜¯seleniumï¼Ÿ

é…ç½®selenium

å®‰è£…seleniumåº“

å®‰è£…æµè§ˆå™¨é©±åŠ¨ï¼ˆä»¥Chromeä¸ºä¾‹ï¼‰ 

ä½¿ç”¨seleniumåº“

ä¾‹1ï¼šå®ç°æ‰“å¼€ç½‘é¡µæ‹¿å–ç½‘é¡µæ ‡é¢˜

è¿è¡Œæ•ˆæœ

ä¾‹2ï¼šå®ç°æŠ“å–æŸæ‹›è˜ç½‘ç«™Pythonå²—ä½çš„èŒä½ä¿¡æ¯

è¿è¡Œæ•ˆæœ

ä¾‹3ï¼šå®ç°æŠ“å–æ¨èæ–°é—»çš„æ ‡é¢˜å’Œæ­£æ–‡ï¼ˆæ¶‰åŠå­é¡µé¢çš„åˆ‡æ¢ï¼‰

è¿è¡Œæ•ˆæœ

ä¾‹4ï¼šå¤„ç†iframeå†…è”æ¡†æ¶ï¼ˆè§†é¢‘æ’­æ”¾å™¨ã€è¡¨æ ¼æ•°æ®ç­‰å¸¸è§ï¼‰

è¿è¡Œæ•ˆæœ

ä¾‹5ï¼šâ€œæ— å¤´æµè§ˆå™¨â€ï¼Œå³æµè§ˆå™¨åœ¨åç«¯è¿è¡ŒæŠ“å–æ•°æ®ï¼Œæ•ˆæœç­‰åŒä½æ•ˆç‡çš„çˆ¬è™«ç¨‹åº

è¿è¡Œæ•ˆæœ

æ€»ç»“

* * *

### å‰è¨€

çˆ¬è™«èµ°åˆ°ä»Šå¤©ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ è¿‡ä¸å°‘æ–¹æ³•ï¼Œæ¥è§£æç½‘é¡µæºä»£ç ã€æŠ“åŒ…ã€å®¡æŸ¥å…ƒç´ ã€åŠ å¯†è§£å¯†......ä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶ä¼šä¸ä¼šè¿™æ ·æƒ³ï¼šå¯ä¸å¯ä»¥ç›´æ¥æ‹¿åˆ°æµè§ˆå™¨ç›´æ¥æ˜¾ç¤ºçš„ä¿¡æ¯å‘¢ï¼Ÿï¼Ÿï¼Ÿ

å› ä¸ºæˆ‘ä»¬ç»å¸¸çœ‹åˆ°ï¼Œæ•°æ®æ˜æ˜å°±æ‘†åœ¨æˆ‘ä»¬æµè§ˆå™¨çš„é¡µé¢ä¸Šï¼Œä½†æ˜¯è‹¦äºæºä»£ç çš„ç©ºæ´ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ç¿»ç®±å€’æŸœçš„å»æ‰¾jsonï¼Œå»æ‰¾jsè¯·æ±‚ç­‰ç­‰ã€‚å¾ˆå¤šæ—¶å€™æ•°æ®ç‰¹åˆ«éšè”½ï¼Œä»¤äººååˆ†å´©æºƒï¼Œæœ‰æ—¶ç”šè‡³ä¼šæƒ³ç›´æ¥åœ¨æµè§ˆå™¨CVäº†ä¹‹ï¼

æ‰€ä»¥ï¼Œæœ‰æƒ³æ³•ï¼Œé‚£å°±è§£å†³ï¼ä½ ä¸æ˜¯èƒ½æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šå—ï¼Ÿä½ ä¸æ˜¯èƒ½CVä¸èƒ½æˆªå–ä¿¡æ¯å—ï¼ŸOKï¼Œæˆ‘è®©**Pythonè‡ªåŠ¨å¸®æˆ‘è¿è¡Œæµè§ˆå™¨ï¼Œæ‹¿æˆ‘æƒ³è¦çš„å†…å®¹** ï¼š**selenium** å°±è¿™æ ·åº”è¿è€Œæ¥äº†ã€‚

* * *

### ä»€ä¹ˆæ˜¯seleniumï¼Ÿ

æ¥è‡ª[ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/Selenium/18266 "ç™¾åº¦ç™¾ç§‘")ï¼š

> Seleniumæ˜¯ä¸€ä¸ªç”¨äºWebåº”ç”¨ç¨‹åºæµ‹è¯•çš„[å·¥å…·](https://baike.baidu.com/item/%E5%B7%A5%E5%85%B7/81891?fromModule=lemma_inlink "å·¥å…·")ã€‚Seleniumæµ‹è¯•ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå°±åƒçœŸæ­£çš„ç”¨æˆ·åœ¨æ“ä½œä¸€æ ·ã€‚æ”¯æŒçš„æµè§ˆå™¨åŒ…æ‹¬[IE](https://baike.baidu.com/item/IE/69103?fromModule=lemma_inlink "IE")ï¼ˆ7, 8, 9, 10, 11ï¼‰ï¼Œ[Mozilla Firefox](https://baike.baidu.com/item/Mozilla%20Firefox/3504923?fromModule=lemma_inlink "Mozilla Firefox")ï¼Œ[Safari](https://baike.baidu.com/item/Safari/597?fromModule=lemma_inlink "Safari")ï¼Œ[Google](https://baike.baidu.com/item/Google/86964?fromModule=lemma_inlink "Google") [Chrome](https://baike.baidu.com/item/Chrome/5633839?fromModule=lemma_inlink "Chrome")ï¼Œ[Opera](https://baike.baidu.com/item/Opera/25140?fromModule=lemma_inlink "Opera")ï¼ŒEdgeç­‰ã€‚è¿™ä¸ªå·¥å…·çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šæµ‹è¯•ä¸æµè§ˆå™¨çš„å…¼å®¹æ€§â€”â€”æµ‹è¯•åº”ç”¨ç¨‹åºçœ‹æ˜¯å¦èƒ½å¤Ÿå¾ˆå¥½å¾—å·¥ä½œåœ¨ä¸åŒæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¹‹ä¸Šã€‚æµ‹è¯•ç³»ç»ŸåŠŸèƒ½â€”â€”åˆ›å»ºå›å½’æµ‹è¯•æ£€éªŒè½¯ä»¶åŠŸèƒ½å’Œç”¨æˆ·éœ€æ±‚ã€‚æ”¯æŒè‡ªåŠ¨å½•åˆ¶åŠ¨ä½œå’Œè‡ªåŠ¨ç”Ÿæˆ.Netã€[Java](https://baike.baidu.com/item/Java/85979?fromModule=lemma_inlink "Java")ã€[Perl](https://baike.baidu.com/item/Perl/851577?fromModule=lemma_inlink "Perl")ç­‰ä¸åŒè¯­è¨€çš„æµ‹è¯•è„šæœ¬ã€‚

ç”±ä¸Šè¿°ç®€ä»‹å¯å¾—ï¼Œseleniumå¯ä»¥å¸®åŠ©æˆ‘ä»¬**è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è¿è¡Œ** æ‰“å¼€æƒ³è¦çš„ç½‘é¡µï¼Œå¹¶ä¸”**æ¨¡ä»¿äºº** çš„CVæ“ä½œã€è¾“å…¥æ“ä½œç­‰ï¼Œè¿›è€Œè·å–ä¸€å¤§å †æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚

* * *

### é…ç½®selenium

seleniuméœ€è¦ä¸¤æ–¹é¢ï¼Œç¬¬ä¸€ä¸ªå½“ç„¶å°±æ˜¯å®‰è£…å¯¹åº”çš„åº“ï¼Œè€Œå¦ä¸€æ–¹é¢å°±æ˜¯è¦å®‰è£…æµè§ˆå™¨å¯¹åº”çš„é©±åŠ¨ç¨‹åºï¼Œå¹¶ç§»åŠ¨åˆ°Pythonè§£é‡Šå™¨æ‰€åœ¨è·¯å¾„ã€‚

#### å®‰è£…seleniumåº“

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/89eaa3af64c6.png)

å®‰è£…å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥åœ¨Terminalä¸­pip install seleniumï¼Œå½“ç„¶åœ¨cmdé‡Œã€anacondaé‡Œéƒ½æ˜¯ä¸€æ ·çš„

#### å®‰è£…æµè§ˆå™¨é©±åŠ¨ï¼ˆä»¥Chromeä¸ºä¾‹ï¼‰ 

1\. è®¿é—®[ChromeDriver - WebDriver for Chrome - Downloads (chromium.org)](https://chromedriver.chromium.org/downloads "ChromeDriver - WebDriver for Chrome - Downloads \(chromium.org\)")

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/5af20401d197.png)

2\. æ ¹æ®è‡ªå·±Chromeæµè§ˆå™¨çš„ç‰ˆæœ¬å·é€‰æ‹©é©±åŠ¨æ–‡ä»¶ï¼ˆæ‰¾ä¸åˆ°å°±å‘ä¸‹å–æœ€æ¥è¿‘çš„ï¼Œæ¯”å¦‚ä½ æ˜¯109.0.9ï¼Œä½†æ˜¯æ²¡æœ‰ï¼Œé‚£å°±ä¸‹è½½109.0.5ï¼Œä¸€èˆ¬éƒ½æ˜¯å‘ä¸‹å…¼å®¹çš„ï¼‰ 

**å¦‚ä½•æŸ¥çœ‹æµè§ˆå™¨ç‰ˆæœ¬å·ï¼Ÿ**

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/017b05208399.png)

æŒ‰ä¸Šå›¾æ‰€ç¤ºï¼Œç‚¹å‡»å…³äºGoogle Chromeï¼Œå¼¹å‡ºä»¥ä¸‹ç•Œé¢ï¼š

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/e3d42741289c.png)è¿™é‡Œæ˜¾ç¤ºçš„å°±æ˜¯ç‰ˆæœ¬å·äº†ï¼Œä¾æ®è¿™ä¸ªåˆ°ç¬¬ä¸€ç‚¹æ‰€è¯´çš„ç½‘ç«™é‡Œå»é€‰é©±åŠ¨ï¼Œè¿™é‡Œæˆ‘æ ¹æ®ç‰ˆæœ¬å·é€‰æ‹©109ç‰ˆæœ¬çš„ï¼š

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/deea44c55d0b.png)

ç”±äºæˆ‘æ˜¯Windowsç³»ç»Ÿï¼Œæ‰€ä»¥é€‰æ‹©ç¬¬å››ä¸ªï¼Œmacçš„åŒå­¦è‡ªè¡Œé€‰æ‹©å‰é¢å¯¹åº”çš„

**ï¼ˆåˆ«æ‹…å¿ƒï¼Œ32ä½64ä½éƒ½å¯é€‰win32ï¼Œå†è¯´ä¹Ÿæ²¡win64é€‰é¡¹å˜›** ï¼‰

3\. ä¸‹è½½è§£å‹

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/5dfd4f2cf64a.png)

å¦‚å›¾æ‰€ç¤ºï¼Œè§£å‹å‡ºæ¥æ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†å®ƒä»¬å‰ªåˆ‡ï¼Œç²˜è´´åˆ°Pythonè§£é‡Šå™¨æ‰€åœ¨è·¯å¾„ã€‚

**ä¸çŸ¥é“è§£é‡Šå™¨åœ¨å“ªé‡Œï¼Ÿ**

**1\. å¦‚æœä½ æ˜¯Anacondaè™šæ‹Ÿç¯å¢ƒï¼Œç›´æ¥å»â€œAnaconda3/envs/è™šæ‹Ÿç¯å¢ƒåâ€è·¯å¾„å°±è¡Œ**

**2\. å…¶ä»–æ¸ é“ç¯å¢ƒï¼šåªéœ€è¦åœ¨PyCharmæˆ–è€…å…¶ä»–è½¯ä»¶é‡Œè¿è¡Œä¸€ä¸‹å°±çœ‹å¾—åˆ°è§£é‡Šå™¨ä½ç½®äº†ï¼š**

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/32e59d4e1806.png)

å¤åˆ¶è¿›å»ï¼Œ**é…ç½®å®Œæ¯•** ã€‚ï¼ˆæˆ‘çš„æ˜¯Anacondaç¯å¢ƒï¼Œä»…ä¾›å‚è€ƒï¼‰

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/a1c635c18d16.png)

* * *

### ä½¿ç”¨seleniumåº“

#### ä¾‹1ï¼šå®ç°æ‰“å¼€ç½‘é¡µæ‹¿å–ç½‘é¡µæ ‡é¢˜

```python from selenium import webdriver # è®©seleniumå¯åŠ¨è°·æ­Œæµè§ˆå™¨ # 1.åˆ›å»ºæµè§ˆå™¨å¯¹è±¡ # è®¾ç½® options = webdriver.ChromeOptions() options.add_experimental_option('detach', True) options.add_argument('--start-maximized') # æµè§ˆå™¨çª—å£æœ€å¤§ web = webdriver.Chrome(options=options) # 2.æ‰“å¼€ä¸€ä¸ªç½‘å€ web.get("http://www.baidu.com") print(web.title) ``` 

ç”±äºå½“å‰Python3.8ç‰ˆæœ¬ä¼šé»˜è®¤åœ¨æ‰§è¡Œå®Œä»»åŠ¡åå…³é—­æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¦‚æœæƒ³çœ‹æ•ˆæœä¼šè½¬ç¬å³é€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦**é…ç½®** ä¸€ä¸‹webdriverï¼š

ç¬¬ä¸€é¡¹å°±æ˜¯æ§åˆ¶æ‰§è¡Œå®Œæ¯•ä»¥åä¸å…³é—­æµè§ˆå™¨çª—å£ï¼Œç¬¬äºŒé¡¹å°±æ˜¯è®©æµè§ˆå™¨å¼¹å‡ºæ—¶æ˜¯æœ€å¤§åŒ–çª—å£ã€‚

#### è¿è¡Œæ•ˆæœ

#### ![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/b3390aaf3e0c.png)

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/58d87f27d454.png)

å¯ä»¥çœ‹åˆ°æ•ˆæœæ˜¯éå¸¸æˆåŠŸçš„ï¼Œæµè§ˆå™¨è‡ªåŠ¨è¿è¡Œäº†ï¼Œå¹¶ä¸”è¾“å‡ºäº†æœŸæœ›ç»“æœï¼Œä¹Ÿè¯´æ˜ç¯å¢ƒæ­å»ºæˆåŠŸã€‚

#### ä¾‹2ï¼šå®ç°æŠ“å–æŸæ‹›è˜ç½‘ç«™Pythonå²—ä½çš„èŒä½ä¿¡æ¯

```python from selenium import webdriver from selenium.webdriver.common.by import By from selenium.webdriver.common.keys import Keys import time # è®©seleniumå¯åŠ¨è°·æ­Œæµè§ˆå™¨ # 1.åˆ›å»ºæµè§ˆå™¨å¯¹è±¡ # è®¾ç½® options = webdriver.ChromeOptions() options.add_experimental_option('detach', True) options.add_argument('--start-maximized') # æµè§ˆå™¨çª—å£æœ€å¤§ web = webdriver.Chrome(options=options) # 2.æ‰“å¼€ä¸€ä¸ªç½‘å€ web.get("http://lagou.com") # æ‰¾åˆ°æŸä¸ªå…ƒç´ . ç‚¹å‡»å®ƒ el = web.find_element(By.XPATH, '//*[@id="changeCityBox"]/ul/li[1]/a') el.click() # ç‚¹å‡»äº‹ä»¶ time.sleep(1) # è®©æµè§ˆå™¨ç¼“ä¸€ä¼šå„¿ # æ‰¾åˆ°è¾“å…¥æ¡†. è¾“å…¥python => è¾“å…¥å›è½¦/ç‚¹å‡»æœç´¢æŒ‰é’® web.find_element(By.XPATH, '//*[@id="search_input"]').send_keys("python", Keys.ENTER) time.sleep(1) # æŸ¥æ‰¾å­˜æ”¾æ•°æ®çš„ä½ç½®. è¿›è¡Œæ•°æ®æå– # æ‰¾åˆ°é¡µé¢ä¸­å­˜æ”¾æ•°æ®çš„æ‰€æœ‰çš„li item_list = web.find_elements(By.XPATH, '//*[@id="jobList"]/div[1]/div') for item in item_list: job_name = item.find_element(By.XPATH, "./div[1]/div[1]/div[1]/a").text job_price = item.find_element(By.XPATH, "./div[1]/div[1]/div[2]/span").text company_name = item.find_element(By.XPATH, './div[1]/div[2]/div[1]/a').text print(company_name, job_name, job_price) ``` 

è¿™é‡Œç»“åˆäº†XPathçš„çŸ¥è¯†ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®åœ¨å½“å‰é¡µé¢çš„æ“ä½œï¼Œç„¶ååœ¨å®¡æŸ¥å…ƒç´ ä¸­æ‰¾åˆ°å¯¹åº”çš„XPathè·¯å¾„ï¼Œå¥—å…¥å‡½æ•°å°±å¯ä»¥äº†ã€‚

æˆ‘ä»¬æ˜¯è¦å…ˆç‚¹å‡»é€‰æ‹©æ‰€åœ¨åŸå¸‚ï¼Œç„¶åè¾“å…¥è¦æœç´¢çš„æ–‡æœ¬ï¼ˆpythonï¼‰ï¼Œæœ€åè·å–é¡µé¢ä¸­å­˜æ”¾æ•°æ®çš„æ‰€æœ‰liï¼Œæ‰“å°è¾“å‡ºå³å¯ã€‚

è¿™é‡Œåªæ˜¯ä¸€ä¸ªç²—ç³™çš„ä¾‹å­ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©å¤§å®¶äº†è§£seleniumçš„åŠŸèƒ½ï¼Œå®Œå–„è¿™ä¸ªå°é¡¹ç›®å¤§å®¶å¯ä»¥è‡ªå·±åŠ¨æ‰‹è¯•ä¸€è¯•ï¼Œåé¢æœ‰æ—¶é—´çš„è¯æˆ‘ä¹Ÿä¼šå†™ä¸€å†™è¡¥å……ä¸‹æ¥ã€‚

#### è¿è¡Œæ•ˆæœ

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/f26d029ca283.png)

å¯ä»¥çœ‹åˆ°ä¹Ÿæ˜¯æˆåŠŸæŠ“å–åˆ°äº†ï¼Œæ›´åŠ ç»†åŒ–çš„å·¥ä½œäº¤ç»™å¤§å®¶æ¥å®Œæˆï¼Œæˆ‘å°±ä¸èµ˜è¿°äº†ã€‚

#### ä¾‹3ï¼šå®ç°æŠ“å–æ¨èæ–°é—»çš„æ ‡é¢˜å’Œæ­£æ–‡ï¼ˆæ¶‰åŠå­é¡µé¢çš„åˆ‡æ¢ï¼‰

```python from selenium import webdriver from selenium.webdriver.common.by import By import time # è®©seleniumå¯åŠ¨è°·æ­Œæµè§ˆå™¨ # 1.åˆ›å»ºæµè§ˆå™¨å¯¹è±¡ # è®¾ç½® options = webdriver.ChromeOptions() options.add_experimental_option('detach', True) options.add_argument('--start-maximized') # æµè§ˆå™¨çª—å£æœ€å¤§ web = webdriver.Chrome(options=options) # 2.æ‰“å¼€ä¸€ä¸ªç½‘å€ web.get("http://tuijian.hao123.com/") # æ‹¿åˆ°æ–°é—»æ ‡é¢˜ news_header = web.find_element(By.XPATH, '//*[@id="sdIndex"]/ul/li[1]/a/span').text # ç‚¹å‡»è¿›å…¥é¦–é¡µæ¨èçš„ç¬¬ä¸€ä¸ªæ¨ªå¹…æ–°é—» web.find_element(By.XPATH, '//*[@id="sdIndex"]/ul/li[1]/a/span').click() time.sleep(1) # è¿›å…¥åˆ°è¿›çª—å£ä¸­è¿›è¡Œæå– # æ³¨æ„, åœ¨seleniumçš„çœ¼ä¸­. æ–°çª—å£é»˜è®¤æ˜¯ä¸åˆ‡æ¢è¿‡æ¥çš„ï¼ web.switch_to.window(web.window_handles[-1]) # åœ¨æ–°çª—å£ä¸­æå–å†…å®¹ news_detail = web.find_element(By.XPATH, '//*[@id="main-content"]/div[1]/div/div[2]').text print(news_header) print(news_detail) time.sleep(1) # å…³æ‰å­çª—å£ web.close() # å˜æ›´seleniumçš„çª—å£è§†è§’. å›åˆ°åŸæ¥çš„çª—å£ä¸­ web.switch_to.window(web.window_handles[0]) print(web.title) ``` 

è¿™ä¸ªå°±å’Œä¸Šä¸€ä¸ªä¾‹å­å¤§åŒå°å¼‚ï¼Œæœ€å¤§çš„ä¸åŒç‚¹å°±åœ¨äº**æ–°é—»å†…å®¹æ˜¯åœ¨å­é¡µé¢è·å–** çš„ï¼Œå¹¶ä¸”è·å–å®Œæ¯•ä»¥ååˆ‡æ¢å›äº†ä¸»é¡µé¢ï¼Œå¯ä»¥ç»§ç»­çˆ¬å–å…¶ä»–æ–°é—»ã€‚

è¿™é‡Œä½¿ç”¨çš„æ˜¯**web.switch_to.window** è¿™ä¸ªapiï¼Œç”¨**web.window_handles[num]** æ¥ä»£æŒ‡ç¬¬**num+1** ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µã€‚

#### è¿è¡Œæ•ˆæœ

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/f25a10292575.png)

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/c7256a519f93.png)

æˆåŠŸæ‹¿åˆ°äº†æƒ³è¦çš„æ•°æ®ï¼Œè¿™ä¸ªè‡ªåŠ¨åŒ–çš„è¿‡ç¨‹è¿˜æ˜¯éå¸¸æœ‰Bæ ¼çš„ï¼

#### ä¾‹4ï¼šå¤„ç†iframeå†…è”æ¡†æ¶ï¼ˆè§†é¢‘æ’­æ”¾å™¨ã€è¡¨æ ¼æ•°æ®ç­‰å¸¸è§ï¼‰

```python from selenium import webdriver from selenium.webdriver.common.by import By import time # å¦‚æœé¡µé¢ä¸­é‡åˆ°äº† iframeå¦‚ä½•å¤„ç† web.get("https://www.csdn.net/?spm=1010.2135.3001.4476") time.sleep(3) # å¤„ç†iframeçš„è¯. å¿…é¡»å…ˆæ‹¿åˆ°iframe. ç„¶ååˆ‡æ¢è§†è§’åˆ°iframe . å†ç„¶åæ‰å¯ä»¥æ‹¿æ•°æ® iframe = web.find_element(By.XPATH, '//*[@id="kp_box_589"]/iframe') web.switch_to.frame(iframe) # åˆ‡æ¢åˆ°iframe time.sleep(1) print(web.find_element(By.XPATH, '//*[@id="1001319"]/div/div/span').text) web.switch_to.default_content() # åˆ‡æ¢å›åŸé¡µé¢ time.sleep(1) print(web.find_element(By.XPATH, '//*[@id="www-home-right"]/div[1]/div[1]/div[2]/div/span').text) ``` 

ä»¥æˆ‘ä»¬Cç«™çš„ä¸»é¡µä¸å¹¿å‘Šæ ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²ç»å¯ä»¥æˆåŠŸåˆ‡æ¢è¿›å¹¿å‘Šæ ï¼ˆiframeï¼‰å¹¶ä¸”åˆ‡å‡ºæ¥

#### è¿è¡Œæ•ˆæœ

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/b6c9c19fb4c0.png)

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/8fe89af03438.png)

* * *

#### ä¾‹5ï¼šâ€œæ— å¤´æµè§ˆå™¨â€ï¼Œå³æµè§ˆå™¨åœ¨åç«¯è¿è¡ŒæŠ“å–æ•°æ®ï¼Œæ•ˆæœç­‰åŒä½æ•ˆç‡çš„çˆ¬è™«ç¨‹åº

```python from selenium.webdriver import Chrome from selenium.webdriver.chrome.options import Options from selenium.webdriver.support.select import Select from selenium.webdriver.common.by import By import time # å‡†å¤‡å¥½å‚æ•°é…ç½® opt = Options() opt.add_argument("--headless") opt.add_argument("--disable-gpu") web = Chrome(options=opt) # æŠŠå‚æ•°é…ç½®è®¾ç½®åˆ°æµè§ˆå™¨ä¸­ web.get("https://www.endata.com.cn/BoxOffice/BO/Year/index.html") time.sleep(2) # å®šä½åˆ°ä¸‹æ‹‰åˆ—è¡¨ sel_el = web.find_element(By.XPATH, '//*[@id="OptionDate"]') # å¯¹å…ƒç´ è¿›è¡ŒåŒ…è£…, åŒ…è£…æˆä¸‹æ‹‰èœå• sel = Select(sel_el) # è®©æµè§ˆå™¨è¿›è¡Œè°ƒæ•´é€‰é¡¹ for i in range(len(sel.options)): # iå°±æ˜¯æ¯ä¸€ä¸ªä¸‹æ‹‰æ¡†é€‰é¡¹çš„ç´¢å¼•ä½ç½® sel.select_by_index(i) # æŒ‰ç…§ç´¢å¼•è¿›è¡Œåˆ‡æ¢ time.sleep(2) table = web.find_element(By.XPATH, '//*[@id="TableList"]/table') print(table.text) # æ‰“å°æ‰€æœ‰æ–‡æœ¬ä¿¡æ¯ print("===================================") print("è¿è¡Œå®Œæ¯•. ") web.close() # å¦‚ä½•æ‹¿åˆ°é¡µé¢ä»£ç Elements(ç»è¿‡æ•°æ®åŠ è½½ä»¥åŠjsæ‰§è¡Œä¹‹åçš„ç»“æœçš„htmlå†…å®¹) print(web.page_source) ``` 

å…¶å®â€œæ— å¤´â€çš„å®ç°å¾ˆç®€å•ï¼Œä¹Ÿæ˜¯é€šè¿‡**é…ç½®æµè§ˆå™¨æ¥å£çš„è®¾ç½®å‚æ•°** ï¼Œheadlesså°±æ˜¯ä¸æ˜¾ç¤ºé¡µé¢ï¼Œdisable-gpuå°±æ˜¯ä¸ºäº†èŠ‚çº¦ç®—åŠ›ï¼Œä¸å»è°ƒç”¨gpuèµ„æºã€‚

å…¶ä½™ä»£ç å¾ˆæ˜æ˜¾ï¼ŒæŒ‰éƒ¨å°±ç­è·å–XPathï¼Œç„¶åæ‹¿åˆ°å¯¹åº”çš„æ•°æ®å³å¯ã€‚

è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªä¸‹æ‹‰èœå•çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬å…ˆç”¨XPathå®šä½åˆ°è¿™ä¸ªå…ƒç´ ï¼Œéšåç”¨**Selectæ¥å£** å°†å…¶åŒ…è£…æˆä¸‹æ‹‰èœå•å…ƒç´ å°±å¯ä»¥è®©seleniumå°†å…¶è¯†åˆ«äº†ï¼Œä»è€Œè¿›è¡Œä¸€ç³»åˆ—åˆ‡æ¢æ“ä½œã€‚æ³¨æ„åˆ‡æ¢ä»¥åä¸€å®šè¦ç­‰å¾…å‡ ç§’é’Ÿï¼Œå¦åˆ™æ•°æ®åŠ è½½ä¸å…¨å°±å®Œäº†ã€‚

è¿è¡Œå‘ç°æˆ‘ä»¬æ‰€éœ€è¦çš„ç”µå½±ç¥¨æˆ¿è®°å½•å·²ç»å…¨éƒ¨æŒ‰å¹´ä»½æ‹¿åˆ°äº†ï¼š

#### è¿è¡Œæ•ˆæœ

![](/images/posts/26.-seleniumï¼šæµè§ˆå™¨è‡ªåŠ¨æµ‹è¯•æ¨¡å—â€”â€”ä¸€æ¬¾æ–¹ä¾¿ä¸”èƒ½/37599c3c2c70.png)

* * *

### æ€»ç»“

é€šè¿‡æœ¬èŠ‚å­¦ä¹ ï¼Œæˆ‘ä»¬è®¤è¯†äº†seleniumæ¨¡å—å¹¶ç”¨å®ƒå†™äº†äº”ä¸ªå¯å®Œå–„çš„å®ä¾‹ï¼Œè®©è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ä»£æ›¿çˆ¬è™«ç¹ççš„è§£å¯†æŠ“åŒ…ç­‰è¿‡ç¨‹ï¼Œåœ¨ç‰¹å®šåœºæ™¯ä¸‹æ˜¯æœ‰å¥‡æ•ˆçš„ã€‚
