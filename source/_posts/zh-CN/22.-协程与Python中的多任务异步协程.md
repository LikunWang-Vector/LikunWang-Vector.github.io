---
title: "22. åç¨‹ä¸Pythonä¸­çš„å¤šä»»åŠ¡å¼‚æ­¥åç¨‹"
date: 2023-01-10
updated: 2023-01-10
categories:
  - Pythonçˆ¬è™«å…¥é—¨ã€è¿›é˜¶ä¸å®æˆ˜
tags:
  - python
  - å¼€å‘è¯­è¨€
  - å¼‚æ­¥
  - åç¨‹
csdn_views: 625
csdn_likes: 6
csdn_comments: 1
csdn_favorites: 10
csdn_url: https://blog.csdn.net/m0_59180666/article/details/128626343
cover: /images/posts/22.-åç¨‹ä¸Pythonä¸­çš„å¤šä»»åŠ¡å¼‚æ­¥åç¨‹/d71926bfed35.png
lang_pair:
  en: "22. Coroutines and Async Multi-task Programming in Python"
---

> æœ¬æ–‡è¿ç§»è‡ªCSDNåšå®¢
> åŸæ–‡é“¾æ¥ï¼š[22. åç¨‹ä¸Pythonä¸­çš„å¤šä»»åŠ¡å¼‚æ­¥åç¨‹](https://blog.csdn.net/m0_59180666/article/details/128626343)
> ğŸ“Š 625 é˜…è¯» | ğŸ‘ 6 ç‚¹èµ | ğŸ’¬ 1 è¯„è®º | â­ 10 æ”¶è—

**ç›®å½•**

å‰è¨€

åç¨‹æ¦‚å¿µ

ç¤ºä¾‹ä»£ç 

Pythonç¼–å†™åç¨‹ç¨‹åº

è¦ç”¨åˆ°çš„åº“å‡½æ•°

å°è¯•ç¼–å†™å¼‚æ­¥

å°è¯•æ”¹è¿›å‡½æ•°

å°è¯•ä¼˜åŒ–ä»£ç 

åœ¨çˆ¬è™«é¢†åŸŸçš„åº”ç”¨ 

æ€»ç»“

* * *

### å‰è¨€

æœ¬èŠ‚æˆ‘ä»¬ä»‹ç»ä¸€ä¸ªæ–°æ¦‚å¿µï¼šåç¨‹ã€‚åç¨‹é¡¾åæ€ä¹‰ï¼Œæ˜¯ååŠ©æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†ä»‹ç»åç¨‹çš„æ¦‚å¿µå’Œå…¶åœ¨Pythonä¸­çš„åº”ç”¨ã€‚

* * *

### åç¨‹æ¦‚å¿µ

ç™¾åº¦ç™¾ç§‘ï¼ˆåç¨‹ï¼‰ï¼š

> åç¨‹ä¸æ˜¯è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹æ›´ç±»ä¼¼äºå­ä¾‹ç¨‹ï¼Œæˆ–è€…è¯´ä¸å¸¦è¿”å›å€¼çš„[å‡½æ•°è°ƒç”¨](https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8/4127405?fromModule=lemma_inlink "å‡½æ•°è°ƒç”¨")ã€‚
> 
> ä¸€ä¸ªç¨‹åºå¯ä»¥åŒ…å«å¤šä¸ªåç¨‹ï¼Œå¯ä»¥å¯¹æ¯”ä¸ä¸€ä¸ªè¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œå› è€Œä¸‹é¢æˆ‘ä»¬æ¥æ¯”è¾ƒåç¨‹å’Œçº¿ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“å¤šä¸ªçº¿ç¨‹ç›¸å¯¹ç‹¬ç«‹ï¼Œæœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œåˆ‡æ¢å—[ç³»ç»Ÿæ§åˆ¶](https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F%E6%8E%A7%E5%88%B6/16142297?fromModule=lemma_inlink "ç³»ç»Ÿæ§åˆ¶")ï¼›è€Œåç¨‹ä¹Ÿç›¸å¯¹ç‹¬ç«‹ï¼Œæœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å…¶åˆ‡æ¢ç”±è‡ªå·±æ§åˆ¶ï¼Œç”±å½“å‰åç¨‹åˆ‡æ¢åˆ°å…¶ä»–åç¨‹ç”±å½“å‰åç¨‹æ¥æ§åˆ¶ã€‚

æ³¨æ„ï¼Œåç¨‹æ˜¯åº”ç”¨ç¨‹åºå†…éƒ¨åˆ‡æ¢ä¸Šä¸‹æ–‡ï¼Œä¸ä¼šè¿›å…¥å†…æ ¸è¿›è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚

åç¨‹ä¸»è¦ç”¨äºæŸä¸€è¿›ç¨‹CPUè°ƒç”¨ç¡çœ æ—¶æˆ–è€…è¿›è¡ŒI/Oæ“ä½œæ—¶ï¼Œé€‰æ‹©æ€§åœ°åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚**åœ¨å¾®è§‚ä¸Šæ˜¯ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡çš„è¿›è¡Œåˆ‡æ¢ï¼Œåˆ‡æ¢æ¡ä»¶ä¸€èˆ¬å°±æ˜¯IOæ“ä½œã€‚åœ¨å®è§‚ä¸Šï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°çš„å…¶å®æ˜¯å¤šä¸ªä»»åŠ¡ä¸€èµ·åœ¨æ‰§è¡Œï¼ˆå¤šä»»åŠ¡å¼‚æ­¥æ“ä½œï¼‰**

* * *

### ç¤ºä¾‹ä»£ç 

```python import time def func(): print("æˆ‘çˆ±é»æ˜") time.sleep(3) # è®©å½“å‰çš„çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€. CPUæ˜¯ä¸ä¸ºæˆ‘å·¥ä½œçš„ print("æˆ‘çœŸçš„çˆ±é»æ˜") if __name__ == '__main__': func() """ # input() ç¨‹åºä¹Ÿæ˜¯å¤„äºé˜»å¡çŠ¶æ€ # requests.get(bilibili) åœ¨ç½‘ç»œè¯·æ±‚è¿”å›æ•°æ®ä¹‹å‰, ç¨‹åºä¹Ÿæ˜¯å¤„äºé˜»å¡çŠ¶æ€çš„ # ä¸€èˆ¬æƒ…å†µä¸‹, å½“ç¨‹åºå¤„äº IOæ“ä½œçš„æ—¶å€™. çº¿ç¨‹éƒ½ä¼šå¤„äºé˜»å¡çŠ¶æ€ # åç¨‹: å½“ç¨‹åºé‡è§äº†IOæ“ä½œçš„æ—¶å€™. å¯ä»¥é€‰æ‹©æ€§çš„åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ä¸Š. # åœ¨å¾®è§‚ä¸Šæ˜¯ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡çš„è¿›è¡Œåˆ‡æ¢. åˆ‡æ¢æ¡ä»¶ä¸€èˆ¬å°±æ˜¯IOæ“ä½œ # åœ¨å®è§‚ä¸Š,æˆ‘ä»¬èƒ½çœ‹åˆ°çš„å…¶å®æ˜¯å¤šä¸ªä»»åŠ¡ä¸€èµ·åœ¨æ‰§è¡Œ # å¤šä»»åŠ¡å¼‚æ­¥æ“ä½œ # ä¸Šæ–¹æ‰€è®²çš„ä¸€åˆ‡. éƒ½æ˜¯åœ¨å•çº¿ç¨‹çš„æ¡ä»¶ä¸‹ """ ``` 

* * *

### Pythonç¼–å†™åç¨‹ç¨‹åº

#### è¦ç”¨åˆ°çš„åº“å‡½æ•°

```python # pythonç¼–å†™åç¨‹çš„ç¨‹åº import asyncio async def func(): print("ä½ å¥½å•Š, æˆ‘å«èµ›åˆ©äºš") if __name__ == '__main__': g = func() # æ­¤æ—¶çš„å‡½æ•°æ˜¯å¼‚æ­¥åç¨‹å‡½æ•°. æ­¤æ—¶å‡½æ•°æ‰§è¡Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªåç¨‹å¯¹è±¡ # print(g) asyncio.run(g) # åç¨‹ç¨‹åºè¿è¡Œéœ€è¦asyncioæ¨¡å—çš„æ”¯æŒ ``` 

è¦ç¼–å†™å¼‚æ­¥ç¨‹åºï¼Œè¦ç”¨åˆ°asyncioè¿™ä¸ªåº“ï¼Œå®ƒæ˜¯Pythonè‡ªå¸¦çš„ï¼Œç›´æ¥å¯¼å…¥å°±å¯ä»¥ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒä¸èƒ½åœ¨ä¸»å‡½æ•°ä¸­ç›´æ¥è¿è¡Œï¼Œä¼šæŠ›å‡ºErrorï¼Œå› ä¸ºå®ƒç›´æ¥è¿è¡Œè¿”å›çš„æ˜¯ä¸€ä¸ªåç¨‹å¯¹è±¡ã€‚æˆ‘ä»¬å¿…é¡»ç”¨asyncioçš„runå‡½æ•°æ‰èƒ½è¿è¡Œã€‚

#### å°è¯•ç¼–å†™å¼‚æ­¥

```python import asyncio import time async def func1(): print("ä½ å¥½å•Š, æˆ‘å«æè¯") time.sleep(3) # å½“ç¨‹åºå‡ºç°äº†åŒæ­¥æ“ä½œçš„æ—¶å€™. å¼‚æ­¥å°±ä¸­æ–­äº† print("ä½ å¥½å•Š, æˆ‘å«æè¯") async def func2(): print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") time.sleep(2) print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") async def func3(): print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") time.sleep(4) print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") if __name__ == '__main__': f1 = func1() f2 = func2() f3 = func3() tasks = [ f1, f2, f3 ] t1 = time.time() # ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡(åç¨‹) asyncio.run(asyncio.wait(tasks)) # å›ºå®šæ­é… t2 = time.time() print(t2 - t1) ``` 

æˆ‘ä»¬æƒ³ä¸€æ¬¡æ€§æ‰§è¡Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œéœ€è¦æŠŠå®ƒä»¬æ”¾åœ¨åˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”ç”¨asyncioçš„runå‡½æ•°ä¸­åµŒå¥—waitå‡½æ•°æ‰èƒ½å®ç°ï¼Œå®ƒæ˜¯å›ºå®šæ­é…ï¼Œå¯ä»¥å¥—å…¬å¼ã€‚

æ‰“å°ç¨‹åºæ‰§è¡Œæ—¶é—´ï¼Œå‘ç°æ­¤æ—¶æ‰§è¡Œæ—¶é—´å’Œä¸²è¡Œæ‰§è¡Œçš„é€Ÿåº¦å·®ä¸å¤šâ€”â€”ä¹Ÿæ˜¯9ç§’å¤š

**ï¼ˆæ‰“å°æ•°æ®æ—¶é—´+3+2+4ï¼‰ç§’** ã€‚

é—®é¢˜å‡ºåœ¨time.sleep()ã€‚**å½“å¼‚æ­¥å‡½æ•°ä¸­å‡ºç°åŒæ­¥æ“ä½œæ—¶ï¼Œå¼‚æ­¥å°±ä¸­æ–­äº†** ï¼Œæ‰€ä»¥è¿˜æ˜¯åœ¨ç­‰å¾…ç¡çœ æ—¶é—´ä¸­CPUä»€ä¹ˆéƒ½æ²¡æœ‰æ‰§è¡Œã€‚

#### å°è¯•æ”¹è¿›å‡½æ•°

```python import asyncio import time async def func1(): print("ä½ å¥½å•Š, æˆ‘å«æè¯") # time.sleep(3) # å½“ç¨‹åºå‡ºç°äº†åŒæ­¥æ“ä½œçš„æ—¶å€™. å¼‚æ­¥å°±ä¸­æ–­äº† await asyncio.sleep(3) # å¼‚æ­¥æ“ä½œçš„ä»£ç  print("ä½ å¥½å•Š, æˆ‘å«æè¯") async def func2(): print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") # time.sleep(2) await asyncio.sleep(2) print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") async def func3(): print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") # time.sleep(4) await asyncio.sleep(4) print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") if __name__ == '__main__': f1 = func1() f2 = func2() f3 = func3() tasks = [ f1, f2, f3 ] t1 = time.time() # ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡(åç¨‹) asyncio.run(asyncio.wait(tasks)) t2 = time.time() print(t2 - t1) ``` 

æˆ‘ä»¬å°†ç¡çœ æ“ä½œæ”¹ä¸ºå¼‚æ­¥ï¼Œå°è¯•æ‰§è¡Œï¼Œæ‰“å°æ‰§è¡Œæ—¶é—´ä¸º4ç§’å¤š**ï¼ˆæœ€é•¿çš„ç¡çœ æ—¶é—´+è°ƒåº¦æ—¶é—´ï¼‰**

ä½†æˆ‘ä»¬è¿™æ ·å¹¶ä¸æ˜¯æœ€ç†æƒ³åŒ–çš„ä»£ç ï¼Œæˆ‘ä»¬å°†å…¶è¿›è¡Œä¼˜åŒ–ï¼š

#### å°è¯•ä¼˜åŒ–ä»£ç 

```python import time import asyncio async def func1(): print("ä½ å¥½å•Š, æˆ‘å«æè¯") await asyncio.sleep(3) print("ä½ å¥½å•Š, æˆ‘å«æè¯") async def func2(): print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") await asyncio.sleep(2) print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") async def func3(): print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") await asyncio.sleep(4) print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") async def main(): # ç¬¬ä¸€ç§å†™æ³• # f1 = func1() # await f1 # ä¸€èˆ¬awaitæŒ‚èµ·æ“ä½œæ”¾åœ¨åç¨‹å¯¹è±¡å‰é¢ # ç¬¬äºŒç§å†™æ³•(æ¨è) tasks = [ asyncio.create_task(func1()), # py3.8ä»¥ååŠ ä¸Šasyncio.create_task() asyncio.create_task(func2()), asyncio.create_task(func3()) ] await asyncio.wait(tasks) if __name__ == '__main__': t1 = time.time() # ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡(åç¨‹) asyncio.run(main()) t2 = time.time() print(t2 - t1) ``` 

è¿™é‡Œè¿˜æ˜¯æ¨èæŠŠå‡½æ•°æ”¾åœ¨tasksåˆ—è¡¨ä¸­ï¼Œç„¶ååœ¨mainå¼‚æ­¥å‡½æ•°ä¸­å¼‚æ­¥æ‰§è¡Œå¼‚æ­¥å‡½æ•°åˆ—è¡¨ï¼Œç„¶ååœ¨ä¸»ç¨‹åºä¸­è°ƒç”¨mainå¼‚æ­¥å‡½æ•°ã€‚æˆ‘ä»¬ä¾æ—§è¾“å‡ºè¿è¡Œæ—¶é—´ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸå¼‚æ­¥è¿è¡Œï¼š

![](/images/posts/22.-åç¨‹ä¸Pythonä¸­çš„å¤šä»»åŠ¡å¼‚æ­¥åç¨‹/d71926bfed35.png)

å¯ä»¥çœ‹åˆ°æ˜¯æ²¡é—®é¢˜çš„ã€‚

* * *

### åœ¨çˆ¬è™«é¢†åŸŸçš„åº”ç”¨ 

```python import asyncio # åœ¨çˆ¬è™«é¢†åŸŸçš„åº”ç”¨ async def download(url): print("å‡†å¤‡å¼€å§‹ä¸‹è½½") await asyncio.sleep(2) # ç½‘ç»œè¯·æ±‚ requests.get() print("ä¸‹è½½å®Œæˆ") async def main(): urls = [ "http://www.baidu.com", "http://www.bilibili.com", "http://www.163.com" ] # å‡†å¤‡å¼‚æ­¥åç¨‹å¯¹è±¡åˆ—è¡¨ tasks = [] for url in urls: d = asyncio.create_task(download(url)) tasks.append(d) # tasks = [asyncio.create_task(download(url)) for url in urls] # è¿™ä¹ˆå¹²ä¹Ÿè¡Œå“¦~ # ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œ await asyncio.wait(tasks) if __name__ == '__main__': asyncio.run(main()) ``` 

è¿™é‡Œç”¨ç¡çœ ä»£æ›¿äº†ç½‘ç»œè¯·æ±‚æ“ä½œï¼Œç›¸å½“äºä¸€ä¸ªæ¨¡æ¿ï¼Œä»¥åè¦æ‰¹é‡è¯·æ±‚ç½‘é¡µçš„æ—¶å€™å¯ä»¥å¥—ç”¨ã€‚

è¿è¡Œç»“æœï¼š

![](/images/posts/22.-åç¨‹ä¸Pythonä¸­çš„å¤šä»»åŠ¡å¼‚æ­¥åç¨‹/463d0a99e218.png)

* * *

å®Œæ•´ä»£ç 

**è°ƒè¯•è¯·è‡ªè¡Œä¿®æ”¹æ³¨é‡Šéƒ¨åˆ†**

```python # import time # # # def func(): # print("æˆ‘çˆ±é»æ˜") # time.sleep(3) # è®©å½“å‰çš„çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€. CPUæ˜¯ä¸ä¸ºæˆ‘å·¥ä½œçš„ # print("æˆ‘çœŸçš„çˆ±é»æ˜") # # # if __name__ == '__main__': # func() # # """ # # input() ç¨‹åºä¹Ÿæ˜¯å¤„äºé˜»å¡çŠ¶æ€ # # requests.get(bilibili) åœ¨ç½‘ç»œè¯·æ±‚è¿”å›æ•°æ®ä¹‹å‰, ç¨‹åºä¹Ÿæ˜¯å¤„äºé˜»å¡çŠ¶æ€çš„ # # ä¸€èˆ¬æƒ…å†µä¸‹, å½“ç¨‹åºå¤„äº IOæ“ä½œçš„æ—¶å€™. çº¿ç¨‹éƒ½ä¼šå¤„äºé˜»å¡çŠ¶æ€ # # # åç¨‹: å½“ç¨‹åºé‡è§äº†IOæ“ä½œçš„æ—¶å€™. å¯ä»¥é€‰æ‹©æ€§çš„åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ä¸Š. # # åœ¨å¾®è§‚ä¸Šæ˜¯ä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡çš„è¿›è¡Œåˆ‡æ¢. åˆ‡æ¢æ¡ä»¶ä¸€èˆ¬å°±æ˜¯IOæ“ä½œ # # åœ¨å®è§‚ä¸Š,æˆ‘ä»¬èƒ½çœ‹åˆ°çš„å…¶å®æ˜¯å¤šä¸ªä»»åŠ¡ä¸€èµ·åœ¨æ‰§è¡Œ # # å¤šä»»åŠ¡å¼‚æ­¥æ“ä½œ # # # ä¸Šæ–¹æ‰€è®²çš„ä¸€åˆ‡. éƒ½æ˜¯åœ¨å•çº¿ç¨‹çš„æ¡ä»¶ä¸‹ # """ # pythonç¼–å†™åç¨‹çš„ç¨‹åº import asyncio import time # async def func(): # print("ä½ å¥½å•Š, æˆ‘å«èµ›åˆ©äºš") # # # if __name__ == '__main__': # g = func() # æ­¤æ—¶çš„å‡½æ•°æ˜¯å¼‚æ­¥åç¨‹å‡½æ•°. æ­¤æ—¶å‡½æ•°æ‰§è¡Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªåç¨‹å¯¹è±¡ # # print(g) # asyncio.run(g) # åç¨‹ç¨‹åºè¿è¡Œéœ€è¦asyncioæ¨¡å—çš„æ”¯æŒ # async def func1(): # print("ä½ å¥½å•Š, æˆ‘å«æè¯") # # time.sleep(3) # å½“ç¨‹åºå‡ºç°äº†åŒæ­¥æ“ä½œçš„æ—¶å€™. å¼‚æ­¥å°±ä¸­æ–­äº† # await asyncio.sleep(3) # å¼‚æ­¥æ“ä½œçš„ä»£ç  # print("ä½ å¥½å•Š, æˆ‘å«æè¯") # # # async def func2(): # print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") # # time.sleep(2) # await asyncio.sleep(2) # print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") # # # async def func3(): # print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") # await asyncio.sleep(4) # print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") # # # if __name__ == '__main__': # f1 = func1() # f2 = func2() # f3 = func3() # tasks = [ # f1, f2, f3 # ] # t1 = time.time() # # ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡(åç¨‹) # asyncio.run(asyncio.wait(tasks)) # t2 = time.time() # print(t2 - t1) # async def func1(): # print("ä½ å¥½å•Š, æˆ‘å«æè¯") # await asyncio.sleep(3) # print("ä½ å¥½å•Š, æˆ‘å«æè¯") # # # async def func2(): # print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") # await asyncio.sleep(2) # print("ä½ å¥½å•Š, æˆ‘å«ç‹å»ºå›½") # # # async def func3(): # print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") # await asyncio.sleep(4) # print("ä½ å¥½å•Š, æˆ‘å«æé›ªç´") # # # async def main(): # # ç¬¬ä¸€ç§å†™æ³• # # f1 = func1() # # await f1 # ä¸€èˆ¬awaitæŒ‚èµ·æ“ä½œæ”¾åœ¨åç¨‹å¯¹è±¡å‰é¢ # # ç¬¬äºŒç§å†™æ³•(æ¨è) # tasks = [ # asyncio.create_task(func1()), # py3.8ä»¥ååŠ ä¸Šasyncio.create_task() # asyncio.create_task(func2()), # asyncio.create_task(func3()) # ] # await asyncio.wait(tasks) # # # if __name__ == '__main__': # t1 = time.time() # # ä¸€æ¬¡æ€§å¯åŠ¨å¤šä¸ªä»»åŠ¡(åç¨‹) # asyncio.run(main()) # t2 = time.time() # print(t2 - t1) # åœ¨çˆ¬è™«é¢†åŸŸçš„åº”ç”¨ async def download(url): print("å‡†å¤‡å¼€å§‹ä¸‹è½½") await asyncio.sleep(2) # ç½‘ç»œè¯·æ±‚ requests.get() print("ä¸‹è½½å®Œæˆ") async def main(): urls = [ "http://www.baidu.com", "http://www.bilibili.com", "http://www.163.com" ] # å‡†å¤‡å¼‚æ­¥åç¨‹å¯¹è±¡åˆ—è¡¨ tasks = [] for url in urls: d = asyncio.create_task(download(url)) tasks.append(d) # tasks = [asyncio.create_task(download(url)) for url in urls] # è¿™ä¹ˆå¹²ä¹Ÿè¡Œå“¦~ # ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œ await asyncio.wait(tasks) if __name__ == '__main__': asyncio.run(main()) ``` 

* * *

### æ€»ç»“

æˆ‘ä»¬ä»Šå¤©è®¤è¯†äº†åç¨‹å’Œå¼‚æ­¥çˆ¬è™«ï¼Œä¸€æ­¥æ­¥é€æ­¥è®¤è¯†äº†å¼‚æ­¥çš„ä¼˜ç‚¹ï¼Œè¿›ä¸€æ­¥æé«˜äº†æˆ‘ä»¬çš„ç¨‹åºæ•ˆç‡ã€‚
