---
title: "35. å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰"
date: 2023-01-31
updated: 2023-01-31
categories:
  - Pythonçˆ¬è™«å…¥é—¨ã€è¿›é˜¶ä¸å®æˆ˜
tags:
  - éŸ³è§†é¢‘
  - python
  - å¼€å‘è¯­è¨€
  - å°ç™½ç»ƒæ‰‹
csdn_views: 10706
csdn_likes: 19
csdn_comments: 21
csdn_favorites: 69
csdn_url: https://blog.csdn.net/m0_59180666/article/details/128818460
cover: /images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/c0a97a1158f5.png
lang_pair:
  en: "35. Practical: Video Watermark Removal with Python"
---

> æœ¬æ–‡è¿ç§»è‡ªCSDNåšå®¢
> åŸæ–‡é“¾æ¥ï¼š[35. å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰](https://blog.csdn.net/m0_59180666/article/details/128818460)
> ğŸ“Š 10706 é˜…è¯» | ğŸ‘ 19 ç‚¹èµ | ğŸ’¬ 21 è¯„è®º | â­ 69 æ”¶è—

**ç›®å½•**

å‰è¨€

ç›®çš„

æ€è·¯

ä»£ç å®ç°

1\. è¯·æ±‚URLï¼ŒæŸ¥çœ‹æºä»£ç 

2\. æºä»£ç ä¸­æ²¡æœ‰å°±å»æŠ“åŒ…å·¥å…·

3\. æ‹¿åˆ°è§†é¢‘æºé“¾æ¥ï¼Œç»§ç»­æ£€ç´¢æ¥æº

4\. æ‹¿åˆ°æ•°æ®å’Œé“¾æ¥ï¼ŒäºŒè¿›åˆ¶å†™å…¥åˆ°æœ¬åœ°

å®Œæ•´æºç 

è¿è¡Œæ•ˆæœ

æ€»ç»“

* * *

### å‰è¨€

æˆ‘ä»¬åœ¨åˆ·æŸçŸ­è§†é¢‘å¹³å°æ—¶ï¼Œæœ‰äº›è§†é¢‘æˆ‘ä»¬æƒ³ä¿å­˜åˆ°æœ¬åœ°è§‚çœ‹ï¼Œä½†æœªå¼€æ”¾ä¸‹è½½æ¸ é“ï¼Œæˆ–è€…æˆ‘ä»¬æƒ³ä¸‹è½½æ¥æ”¶è—æˆ–è€…åšæˆåŠ¨æ€å£çº¸ï¼Œä½†æ˜¯æœ‰æ°´å°ï¼Œå°±å¾ˆæ¼ç«ã€‚

**ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº**

å°±è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªå°å°çš„ç¨‹åºæ¥å®ç°å»æ°´å°çš„åŠŸèƒ½ã€‚

* * *

### ç›®çš„

ç»™å®šURLï¼Œå®ç°å»é™¤æ°´å°ä¸‹è½½è§†é¢‘çš„æ“ä½œã€‚

**ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº**

* * *

### æ€è·¯

1\. è¯·æ±‚URLï¼ŒæŸ¥çœ‹æºä»£ç 

2\. æºä»£ç ä¸­æ²¡æœ‰å°±å»æŠ“åŒ…å·¥å…·

3\. æ‹¿åˆ°è§†é¢‘æºé“¾æ¥ï¼Œç»§ç»­æ£€ç´¢æ¥æº

4\. æ‹¿åˆ°æ•°æ®å’Œé“¾æ¥ï¼ŒäºŒè¿›åˆ¶å†™å…¥åˆ°æœ¬åœ°

**ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº ç½‘é¡µè¿æ¥æ”¾è¯„è®ºåŒº**

* * *

### ä»£ç å®ç°

#### 1\. è¯·æ±‚URLï¼ŒæŸ¥çœ‹æºä»£ç 

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/c0a97a1158f5.png)

è¯·æ±‚åˆ°ä¸»é¡µï¼Œæ£€æŸ¥å…ƒç´ ï¼Œçœ‹è§†é¢‘æ˜¯å¦åŒ…å«åœ¨æºä»£ç ä¸­ï¼Œç»“æœå‘ç°æ˜¯æ²¡æœ‰çš„ã€‚

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/e49383927d4a.png)

å½“ç„¶ï¼Œè¯·æ±‚URLä¹Ÿå°‘ä¸äº†å¿…è¦çš„è¯·æ±‚å¤´ï¼Œä¼ªè£…è¯·æ±‚å¤´å¦‚ä¸‹ï¼š

```python url = 'è§è¯„è®ºåŒº' headers = { 'cookie': 'douyin.com; __ac_nonce=063d749310021f8bd394b; __ac_signature=_02B4Z6wo00f01R8urHgAAIDBnyxWOmwmfMUfDqjAACQfd6; ttwid=1%7CtRZY98IpvYfhjM-VRDQHgX3mgPcfWwWxylxnwwC7fFk%7C0%7C9af2c384c7d2b4e10ec0497fce797af996c72dd3868ec040595de36132c01ad0; home_can_add_dy_2_desktop=%220%22; passport_csrf_token=ee0cbadbf97ac430daac207c46997ca1; passport_csrf_token_default=ee0cbadbf97ac430daac207c46997ca1; strategyABtestKey=%221675053365.079%22; s_v_web_id=verify_ldibiwgl_ycqaypzT_aJxd_4ZEW_9iGD_XkAPFGlhzwd3; AB_LOGIN_GUIDE_TIMESTAMP=%221675053363589%22; msToken=L3xfxnCP4kW9_qabjW3S1cud_5DmI99tIEOw1_lJDMgdp1GJ9KQd6HWXKepYY-7iLlj4SR_V02zL3lYO6FVnXoPPVNneC5bD9cEnYN4nNpXzaNmvq7oA; ttcid=a598309ef5f3442b95f1d979574083f925; tt_scid=Px0Q21O38QIdeziR7nBXUqfZYJaS4qKakt5Zkfio72r9U4XaJdOYTb37LsjIrRLQca96; msToken=xibNm7RgEpzX8c6UaAgkzAOHMr5TcWNmNbfFR1vD-3uNUhtRXEqVQrmPIV6iDsnsA3WhMCTIOGDtST_F9GEyq8In6Dj7ug-RXsQ6dWDIjzE3OXKr5dlj', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36' } resp = requests.get(url=url, headers=headers) ``` 

**å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ Cookieå’ŒUser-Agent**

#### 2\. æºä»£ç ä¸­æ²¡æœ‰å°±å»æŠ“åŒ…å·¥å…·

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/b353167bc607.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/7fb3e949b022.png)

#### 3\. æ‹¿åˆ°è§†é¢‘æºé“¾æ¥ï¼Œç»§ç»­æ£€ç´¢æ¥æº

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/9f3d3dacac72.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/bc435dea10c7.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/192d7356de6f.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/e785a0b289a4.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/e3d1cc88e3f5.png)

#### 4\. æ‹¿åˆ°æ•°æ®å’Œé“¾æ¥ï¼ŒäºŒè¿›åˆ¶å†™å…¥åˆ°æœ¬åœ°

> ä¸‹é¢å¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–è§†é¢‘æ ‡é¢˜ä½œä¸ºä¸€ä¼šä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
> 
> è¿˜æ˜¯ç”¨æ­£åˆ™æŠ“å–åˆšåˆšscriptéƒ¨åˆ†åŒ…è£¹çš„è§†é¢‘ä¿¡æ¯ï¼Œurlè§£ç åç”¨pprintå°†å­—å…¸ç¾è§‚æ‰“å°
> 
> å‘ç°æœ‰è§„å¾‹å¯å¾ªï¼Œä¸€å±‚ä¸€å±‚æ‰’å¼€ä»¥åæ‰¾åˆ°äº†è§†é¢‘urlçš„ç²¾å‡†ä½ç½®

```python # æ­£åˆ™æŠ“æ ‡é¢˜ obj = re.compile(r"<span><span><span><span>(?P<title>.*?)</span></span></span></span>", re.S) title = obj.search(resp.text).group("title") # print(title) # æ­£åˆ™æŠ“è§†é¢‘ä¿¡æ¯ info = re.findall('<script id="RENDER_DATA" type="application/json">(.*?)</script', resp.text)[0] # print(info) # urlè§£ç  html_data = urllib.parse.unquote(info) html_data = json.loads(html_data) # pprint(html_data) # è®©å­—å…¸æ›´åŠ ç¾è§‚ # å­—å…¸å–å€¼ï¼Œæ‹¿è§†é¢‘æ’­æ”¾é“¾æ¥ video_url = 'https:' + html_data['41']['aweme']['detail']['video']['bitRateList'][0]['playAddr'][0]['src'] print(video_url) ``` 

æœ€åå°±æ˜¯æœ€ç®€å•çš„ä¿å­˜è§†é¢‘

```python # è·å–è§†é¢‘äºŒè¿›åˆ¶æ•°æ® video_content = resp = requests.get(url=video_url, headers=headers).content # ä¿å­˜è§†é¢‘ if not os.path.exists('./4_video_without_watermark'): os.mkdir('./4_video_without_watermark') with open('./4_video_without_watermark/' + title + '.mp4', mode='wb') as f: f.write(video_content) ``` 

* * *

### å®Œæ•´æºç 

```python import requests import re import json import urllib from urllib import parse import os from pprint import pprint """ å¸¸è§„æ‰¾è§†é¢‘èµ„æºï¼šåˆ°Network --> Mediaé‡Œé¢æŠ“åŒ…ï¼Œå°±èƒ½å¾—åˆ°åœ°å€ ç„¶ååœ¨Mediaé‡Œé¢æ‹¿åˆ°åœ°å€ï¼Œå»å…¨å±€æœç´¢URLæ¥æº """ url = 'è§è¯„è®ºåŒº' headers = { 'cookie': 'douyin.com; __ac_nonce=063d749310021f8bd394b; __ac_signature=_02B4Z6wo00f01R8urHgAAIDBnyxWOmwmfMUfDqjAACQfd6; ttwid=1%7CtRZY98IpvYfhjM-VRDQHgX3mgPcfWwWxylxnwwC7fFk%7C0%7C9af2c384c7d2b4e10ec0497fce797af996c72dd3868ec040595de36132c01ad0; home_can_add_dy_2_desktop=%220%22; passport_csrf_token=ee0cbadbf97ac430daac207c46997ca1; passport_csrf_token_default=ee0cbadbf97ac430daac207c46997ca1; strategyABtestKey=%221675053365.079%22; s_v_web_id=verify_ldibiwgl_ycqaypzT_aJxd_4ZEW_9iGD_XkAPFGlhzwd3; AB_LOGIN_GUIDE_TIMESTAMP=%221675053363589%22; msToken=L3xfxnCP4kW9_qabjW3S1cud_5DmI99tIEOw1_lJDMgdp1GJ9KQd6HWXKepYY-7iLlj4SR_V02zL3lYO6FVnXoPPVNneC5bD9cEnYN4nNpXzaNmvq7oA; ttcid=a598309ef5f3442b95f1d979574083f925; tt_scid=Px0Q21O38QIdeziR7nBXUqfZYJaS4qKakt5Zkfio72r9U4XaJdOYTb37LsjIrRLQca96; msToken=xibNm7RgEpzX8c6UaAgkzAOHMr5TcWNmNbfFR1vD-3uNUhtRXEqVQrmPIV6iDsnsA3WhMCTIOGDtST_F9GEyq8In6Dj7ug-RXsQ6dWDIjzE3OXKr5dlj', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36' } resp = requests.get(url=url, headers=headers) # resp = urllib.parse.unquote(resp.text) # print(resp.text) # æ­£åˆ™æŠ“æ ‡é¢˜ obj = re.compile(r"<span><span><span><span>(?P<title>.*?)</span></span></span></span>", re.S) title = obj.search(resp.text).group("title") # print(title) # æ­£åˆ™æŠ“è§†é¢‘ä¿¡æ¯ info = re.findall('<script id="RENDER_DATA" type="application/json">(.*?)</script', resp.text)[0] # print(info) # urlè§£ç  html_data = urllib.parse.unquote(info) html_data = json.loads(html_data) # pprint(html_data) # è®©å­—å…¸æ›´åŠ ç¾è§‚ # å­—å…¸å–å€¼ï¼Œæ‹¿è§†é¢‘æ’­æ”¾é“¾æ¥ video_url = 'https:' + html_data['41']['aweme']['detail']['video']['bitRateList'][0]['playAddr'][0]['src'] print(video_url) # è·å–è§†é¢‘äºŒè¿›åˆ¶æ•°æ® video_content = resp = requests.get(url=video_url, headers=headers).content # ä¿å­˜è§†é¢‘ if not os.path.exists('./4_video_without_watermark'): os.mkdir('./4_video_without_watermark') with open('./4_video_without_watermark/' + title + '.mp4', mode='wb') as f: f.write(video_content) ``` 

* * *

### è¿è¡Œæ•ˆæœ

è¿è¡Œåè¾“å‡ºè§†é¢‘ç›´é“¾ï¼Œå¹¶å·²ç»å°†è§†é¢‘ä¿å­˜åˆ°æœ¬åœ°æŒ‡å®šæ–‡ä»¶å¤¹ã€‚

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/b8dcf0d7ff49.png)

![](/images/posts/35.-å®æˆ˜ï¼šPythonå®ç°è§†é¢‘å»æ°´å°ï¼ˆæ–‡æœ«æºç ï¼‰/7ca18ea3412d.png)

* * *

### æ€»ç»“

æœ¬èŠ‚å®æˆ˜äº†æŸçŸ­è§†é¢‘å¹³å°è§†é¢‘å»æ°´å°çš„è¿‡ç¨‹ï¼Œè¾ƒä¸ºç»¼åˆï¼Œé€‚åˆå·©å›ºçˆ¬è™«åŸºç¡€çŸ¥è¯†ã€‚
