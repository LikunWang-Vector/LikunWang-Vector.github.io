---
title: "å®Œç¾è§£å†³UnicodeEncodeError: â€˜gbkâ€˜ codec canâ€˜t encode character â€˜\xa0â€˜ in position XX: illegal multiby..."
date: 2023-02-02
updated: 2023-02-02
categories:
  - å„ç§Debugå°è®°
tags:
  - python
  - gbk
  - ç¼–ç æ–¹å¼
  - debug
  - ä»£ç è§„èŒƒ
csdn_views: 6671
csdn_likes: 8
csdn_comments: 0
csdn_favorites: 19
csdn_url: https://blog.csdn.net/m0_59180666/article/details/128845077
lang_pair:
  en: "Fix UnicodeEncodeError: 'gbk' codec can't encode character '\xa0'"
---

> æœ¬æ–‡è¿ç§»è‡ªCSDNåšå®¢
> åŸæ–‡é“¾æ¥ï¼š[å®Œç¾è§£å†³UnicodeEncodeError: â€˜gbkâ€˜ codec canâ€˜t encode character â€˜\xa0â€˜ in position XX: illegal multiby...](https://blog.csdn.net/m0_59180666/article/details/128845077)
> ğŸ“Š 6671 é˜…è¯» | ğŸ‘ 8 ç‚¹èµ | ğŸ’¬ 0 è¯„è®º | â­ 19 æ”¶è—

## 

**ç›®å½•**

é¡¹ç›®åœºæ™¯ï¼š

é—®é¢˜æè¿°

åŸå› åˆ†æï¼š

è§£å†³æ–¹æ¡ˆï¼š

replaceå‡½æ•°

å…¶ä»–è§£å†³æ–¹æ³•ï¼ˆæ¥æºç½‘ç»œï¼‰

ä½¿ç”¨re.sub

ä½¿ç”¨translateæ–¹æ³•

åˆ©ç”¨splitæ–¹æ³•

ä½¿ç”¨unicodedataæ¨¡å—

* * *

## é¡¹ç›®åœºæ™¯ï¼š

ä»ç½‘ä¸ŠæŠ“äº†ä¸€äº›å°è¯´çš„æ•°æ®ï¼Œä½†å®é™…ä¸Šç½‘é¡µæ˜¯gbkç¼–ç çš„ï¼Œå†™å…¥txtæ–‡ä»¶çš„æ—¶å€™æŠ¥äº†è¿™ä¸ªé”™è¯¯ï¼š

```XML UnicodeEncodeError: 'gbk' codec can't encode character '\xa0' in position XX: illegal multibyte sequence ``` 

è§‚å¯Ÿå‘ç°'\xa0'å…¶å®æ˜¯å±äº**latin1 ï¼ˆ ISO/IEC_8859-1 ï¼‰ä¸­çš„æ‰©å±•å­—ç¬¦é›†å­—ç¬¦** ï¼Œä»£è¡¨ç©ºç™½ç¬¦ nbsp (non-breaking space) ã€‚ latin1 å­—ç¬¦é›†å‘ä¸‹å…¼å®¹ ASCII ï¼ˆ 0x20~0x7e ï¼‰ã€‚

`\xa0`è¡¨ç¤ºä¸é—´æ–­ç©ºç™½ç¬¦ï¼Œçˆ¬è™«ä¸­é‡åˆ°å®ƒçš„æ¦‚ç‡ä¸å¯è°“ä¸å°ï¼Œè€Œç»å¸¸å’Œå®ƒä¸€åŒå‡ºç°çš„è¿˜æœ‰`\u3000`ã€`\u2800`ã€`\t`ç­‰Unicodeå­—ç¬¦ä¸²ã€‚

* * *

## é—®é¢˜æè¿°

éœ€è¦æŠŠä¸é—´æ–­ç©ºç™½ç¬¦'\xa0'å»é™¤

* * *

## åŸå› åˆ†æï¼š

> åŸå› å¤§æ¦‚å°±æ˜¯\xa0çš„ç¼–ç æ–¹å¼ä¸gbkä¸å…¼å®¹ï¼Œæˆ‘ä½¿ç”¨çš„Windowsç³»ç»Ÿçš„txtæ–‡ä»¶é»˜è®¤æ˜¯gbkç¼–ç çš„ï¼Œæ‰€ä»¥ä¹Ÿä¸å­˜åœ¨æ–‡æœ¬çš„é—®é¢˜ã€‚

æ‰€ä»¥å°±å®šä½åˆ°äº†æŠ“å–åˆ°çš„æ•°æ®ä¸­å«æœ‰æ— æ³•ç¼–è¯‘çš„å­—ç¬¦ã€‚è§‚å¯Ÿå‘ç°åªæœ‰\xa0å‡ºç°ã€‚

* * *

## è§£å†³æ–¹æ¡ˆï¼š

#### replaceå‡½æ•°

æˆ‘çš„è§£å†³æ–¹æ³•ååˆ†æš´åŠ›ï¼Œç›´æ¥ç”¨str.replace('old', 'new')æ¥æ›¿æ¢ã€‚

```python cont = cont.replace('\xa0', ' ') ``` 

è¿™æ ·å°±å®Œç¾è§£å†³äº†ã€‚

* * *

### å…¶ä»–è§£å†³æ–¹æ³•ï¼ˆæ¥æºç½‘ç»œï¼‰

#### ä½¿ç”¨`re.sub`

ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥è½»æ¾åŒ¹é…æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼Œå®ƒå¯¹äºUnicodeå­—ç¬¦ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œæ¯”å¦‚ï¼š

``` >>> import re >>> s = 'T-shirt\xa0\xa0çŸ­è¢–åœ†é¢†è¡«,\u3000ä½“æ¤è¡«\xa0ä¹°ä¸€ä»¶\tå§' >>> re.sub('\s', ' ', s) T-shirt çŸ­è¢–åœ†é¢†è¡«, ä½“æ¤è¡« ä¹°ä¸€ä»¶ å§ ``` 

ä¸è¿‡è¯¥æ­£åˆ™è¡¨è¾¾å¼ä¼šå¯¹æ‰€æœ‰å­—ç¬¦éƒ½è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå¯èƒ½ä¼šä¸åŸé¡µé¢å±•ç¤ºæ•ˆæœæœ‰æ‰€å‡ºå…¥ã€‚

#### ä½¿ç”¨`translate`æ–¹æ³•

`str`å¯¹è±¡çš„`translate`æ–¹æ³•ä¹Ÿæ˜¯å»é™¤è¿™äº›å­—ç¬¦ä¸²çš„å¥½å¸®æ‰‹ï¼Œè¯¥æ–¹æ³•å…·ä½“ç”¨æ³•å¯å‚è€ƒPythonæ ‡å‡†åº“ï¼Œæœ¬å¤„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š

``` >>> inputstring = u'\n Door:\xa0Novum \t' >>> move = dict.fromkeys((ord(c) for c in u"\xa0\n\t")) >>> output = inputstring.translate(move) >>> output Door:Novum ``` 

#### åˆ©ç”¨`split`æ–¹æ³•

å°†å­—ç¬¦ä¸²åˆ†å‰²å†é‡ç»„ï¼Œè¿™æ—¶å€™ç©ºç™½å­—ç¬¦å°±ä¼šè¢«passæ‰äº†ï¼Œä¸è¿‡è¯¥æ–¹æ³•æ€ä¼¤åŠ›å¤ªå¤§ï¼Œä¼šå¯¼è‡´æ‰€æœ‰ç©ºç™½æ¶ˆå¤±ï¼Œä¸€å®šè¦æ…ç”¨ã€‚  
ä½¿ç”¨ç¤ºä¾‹ï¼š

``` >>> s = 'T-shirt\xa0\xa0çŸ­è¢–åœ†é¢†è¡«,\u3000ä½“æ¤è¡«\xa0ä¹°ä¸€ä»¶\tå§' >>> ''.join(s.split()) T-shirtçŸ­è¢–åœ†é¢†è¡«,ä½“æ¤è¡«ä¹°ä¸€ä»¶å§ ``` 

#### ä½¿ç”¨`unicodedata`æ¨¡å—

Pythonæ ‡å‡†åº“çš„`unicodedata`æ¨¡å—æä¾›äº†`normalize`æ–¹æ³•å°†Unicodeå­—ç¬¦è½¬æ¢ä¸ºæ­£å¸¸å­—ç¬¦ï¼Œè¯¥æ–¹æ³•å¯ç®—æ˜¯å¤„ç†è¿™ç±»æƒ…å†µæœ€å¥½çš„æ–¹æ³•äº†ï¼Œå®ƒä¼šè®©å­—ç¬¦å›å½’åˆ°æˆ‘ä»¬æœŸæœ›çœ‹åˆ°çš„æ ·å­ï¼ŒåŒæ—¶ä¸æŸå®³å…¶å®ƒæ­£å¸¸çš„ç©ºç™½å­—ç¬¦ï¼Œè€Œä¸”è¿˜èƒ½è¿˜åŸå…¶å®ƒéç©ºç™½å­—ç¬¦ã€‚`normalize`ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå­—ç¬¦ä¸²æ ‡å‡†åŒ–çš„æ–¹å¼ã€‚ `NFC`è¡¨ç¤ºå­—ç¬¦åº”è¯¥æ˜¯æ•´ä½“ç»„æˆ(æ¯”å¦‚å¯èƒ½çš„è¯å°±ä½¿ç”¨å•ä¸€ç¼–ç )ï¼Œè€Œ`NFD`è¡¨ç¤ºå­—ç¬¦åº”è¯¥åˆ†è§£ä¸ºå¤šä¸ªç»„åˆå­—ç¬¦è¡¨ç¤ºã€‚`Python`åŒæ ·æ”¯æŒæ‰©å±•çš„æ ‡å‡†åŒ–å½¢å¼`NFKC`å’Œ`NFKD`ï¼Œå®ƒä»¬åœ¨å¤„ç†æŸäº›å­—ç¬¦çš„æ—¶å€™å¢åŠ äº†é¢å¤–çš„å…¼å®¹ç‰¹æ€§ã€‚ä½¿ç”¨è¯¥æ–¹æ³•å¤„ç†`\xa0`ç­‰å­—ç¬¦çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š

``` >>> import unicodedata >>> s = 'T-shirt\xa0\xa0çŸ­è¢–åœ†é¢†è¡«,\u3000ä½“æ¤è¡«\xa0ä¹°ä¸€ä»¶\tå§' >>> unicodedata.normalize('NFKC', s) T-shirt çŸ­è¢–åœ†é¢†è¡«, ä½“æ¤è¡« ä¹°ä¸€ä»¶ å§ ``` 
