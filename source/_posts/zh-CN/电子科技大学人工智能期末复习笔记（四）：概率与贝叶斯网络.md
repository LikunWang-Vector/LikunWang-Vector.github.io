---
title: "电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络"
date: 2023-02-09
updated: 2023-02-09
categories:
  - 复习笔记
tags:
  - 概率论
  - 人工智能
  - 贝叶斯网络
  - 拓扑学
  - 抽样
csdn_views: 8040
csdn_likes: 42
csdn_comments: 5
csdn_favorites: 136
csdn_url: https://blog.csdn.net/m0_59180666/article/details/128945806
cover: /images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/25f8d94da6ec.png
lang_pair:
  en: "UESTC Artificial Intelligence Review Notes (4): Probability and Bayesian Networks"
---

> 本文迁移自CSDN博客
> 原文链接：[电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络](https://blog.csdn.net/m0_59180666/article/details/128945806)
> 📊 8040 阅读 | 👍 42 点赞 | 💬 5 评论 | ⭐ 136 收藏

**目录**

前言

概率

概率公式

贝叶斯公式

链式条件概率

例题

1\. 求联合概率分布/边缘概率分布/条件概率分布

2\. 灵活运用贝叶斯公式 

概率总结

贝叶斯网络

判断独立性

两个事件独立的判断

条件独立性的判断

假设条件独立的链式法则

⚠Active / Inactive Paths 判断独立性

贝叶斯网络中的条件概率

​编辑

多重连接和多重消除 Multiple Joins & Multiple Elimination

贝叶斯网络抽样(Bayes' Nets Sampling) 

采样是什么？——Sampling

先验抽样 ▪ Prior Sampling

拒绝抽样 ▪ Rejection Sampling

似然加权 ▪ Likelihood Weighting

吉布斯抽样 ▪ Gibbs Sampling

总结

⚠作业题

* * *

## 前言

本复习笔记基于李晶晶老师的课堂PPT与复习大纲，供自己期末复习与学弟学妹参考用。

**2023-02-10更新：增加了贝叶斯网络中的抽样问题**

* * *

## 概率

* * *

### 概率公式

#### 贝叶斯公式

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/25f8d94da6ec.png) ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/06208f5fc8d3.png)

#### 链式条件概率

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/b05eac62d1d3.png)

* * *

### 例题

#### 1\. 求联合概率分布/边缘概率分布/条件概率分布

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/d06b931327c5.png)

首先明确，P(W | dry)是一个概率分布，而不是一个概率值。不能写成 P(W | dry)=....

**①求联合概率分布****P(D,W)****;**

**②求边缘概率分布****P(D)****;**

**③求条件概率分布****P(W |****D****)****.**

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/c894bb255a00.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/e335fb961575.png)

**P(W | dry)**  
---  
D |  W |  P  
dry |  sun |  0.9231  
dry |  rain |  0.0769  
  
#### 2\. 灵活运用贝叶斯公式 

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/f63c9d8270c8.png)

* * *

### 概率总结

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/97a88a59d43d.png)

* * *

## 贝叶斯网络

* * *

### 判断独立性

#### 两个事件独立的判断

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/740b24463085.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/2d3ff2371cd7.png)

#### 条件独立性的判断

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/277b93868d64.png)

#### 假设条件独立的链式法则

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/967bc404eb7d.png)

* * *

### ⚠Active / Inactive Paths 判断独立性

要判断X，Y的独立性：

1\. 找到X到Y的所有路径paths

2\. 如果一个path的所有三元组都是active那么此path就是active

**3\. 若存在一个path为active，那么X、Y就是非独立的，反之独立**

> **简言之：找到一条path的所有三元组都是active那么就非独立；**
> 
> **若只存在一条路径，那么 找到一个inactive的三元组就独立，如果全部active才非独立。**

**⭐可以把X、Y理解为两个水池，如果 有一根连通水管（path）里的开关全打开了（active）那么二者连通，不独立（independence）；如果就只有一根水管连接，那么只要有一个开关被关闭（inactive）那么就独立。**

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/8abfb7351149.png)

【上图阴影表示确定条件，即given。】

**⭐只需要记 间接因果（中间条件已知）、已知同因（父节点已知）、未知共果是active（子节点未知），其他三个对立的象限自己就出来了。**

[25-bn (washington.edu)](https://courses.cs.washington.edu/courses/cse473/16au/slides-16au/25-bn.pdf "25-bn \(washington.edu\)")

* * *

### 贝叶斯网络中的条件概率

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/c212d870d7c6.png)

文字描述： 遍历每一项，分别以它们的父节点为条件，连乘即可。

举例说明比较直观：

### ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/8081b876df7d.png)

* * *

### 多重连接和多重消除 Multiple Joins & Multiple Elimination

对应乘起来就行了，没什么。

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/c27e5de32394.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/8e473974f986.png)

* * *

### 贝叶斯网络抽样(Bayes' Nets Sampling) 

> 贝叶斯网络的抽样大致分为：
> 
>   * 先验抽样 ▪ Prior Sampling
>   * 拒绝抽样 ▪ Rejection Sampling
>   * 加权抽样 ▪ Likelihood Weighting
>   * 吉布斯抽样 ▪ Gibbs Sampling
> 

> 
> 其目的是进一步加快贝叶斯网络近似的速度。

#### 采样是什么？——Sampling

> 采样，顾名思义就是从特定的概率分布中抽取相应样本点的过程。它可以将复杂的分布简化为离散的样本点、可以用于随机模拟已进行复杂模型的近似求解或推理等。

#### 先验抽样 ▪ Prior Sampling

获取样本的方式为祖先抽样，从父节点开始逐渐扩展，类似于贝叶斯网络中的联合分布，下面以一个经典的例题直观感受一下：

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/40dc401d216a.png)

如图，它的核心思想是根据有向图的顺序，先对祖先节点进行采样，只有当某个节点的所有父节点都已完成采样，采对该结点进行采样。以上图为场景，先对Cloudy变量进行采样，然后对Sprinkle和Rain变量进行采样，最后对WetGrass变量采样。根据贝叶斯网络的全概率公式

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/9003456aff90.png)

可以看出祖先采样得到的样本服从贝叶斯网络的联合概率分布。  
如果只需要对贝叶斯网络中一部分随机变量的边缘分布进行采样，可以用祖先采样对全部随机变量进行采样，然后直接忽视那些不需要的变量的采样值即可。由图可见，如果需要对边缘分布p(Rain)进行采样，先用祖先采样得到全部变量的一个样本，如（Cloudy=T，Sprinkler=T，Rain=T，WetGrass=T），然后忽略掉无关变量，直接把这个样本看成是Coludy=T即可。 

> 大致流程：
> 
>   1. 设一个事件的样本数为：![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/b56a7eec18ab.png)
>   2. 计算生成样本的概率：![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/1d7cc2f037c9.png)
>   3. 套用公式：![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/77b606560498.png)
>   4. 采样程序是一致的，这样就估计出联合分布的概率。
> 

> 
> 例题：
> 
> ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/85539846090f.png)
> 
> 从贝叶斯网络中得到的样本：
> 
> ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/5b13beb079ff.png)
> 
> 需要求P（W）
> 
>   * 计数：+w——4；-w——1
>   * 计算概率：+w——4/5=0.8；-w——1/5=0.2
>   * （样本越多越接近真实概率）
> 

> 
> 总结：
> 
> ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/57776d0baa31.png)

#### 拒绝抽样 ▪ Rejection Sampling

类似，就不赘述了，它采样的方式就是根据条件取，不符合条件的丢弃：

假设在上例中我们要求C的概率，此时保留所有样本就没有意义了，我们选择对C计数；

假设我们想要Ｐ（C|+s），同样的，我们要统计C结果，但忽略（拒绝）没有+s的样本。

这就是拒绝抽样，它对于条件概率而言也是一致的。

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/418c55c14eda.png)

#### 似然加权 ▪ Likelihood Weighting

举一个例子：在有观测变量（Sprikeler = T, WetGrass = T）时，可以先对Cloudy进行采样，再对Rain进行采样，对于Sprikeler、WetGrass则直接赋观察值，得到下面的一个样本：  
![在这里插入图片描述](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/1385446d59a2.png)  
这样得到的样本的重要性权值为：

w 正比于 p(Sprinkler = T| Cloudy = T)_p(WetGrass = T| Sprinkler = T,Rain = T) = 0.1*_ 0.99 = 0.099  
该式子可以理解为：当其他变量取得样本中的取值时(Cloudy = T,Rain = T)，预测变量取得其确定值的可能性。 

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/30a6b83fb0ab.png)

#### 吉布斯抽样 ▪ Gibbs Sampling

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/b4c72e72e18b.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/47a8fb926d75.png)

#### 总结

> 直接采样：按照拓扑顺序依次对每个变量进行采样。变量值被采样的概率分布依赖于父结点已得到的赋值。
> 
> 拒绝采样：给定一个易于采样的分布，为一个难于采样的分布生成采样样本。
> 
> 似然加权（likelihood weighting）只生成与证据e一致的事件，从而避免拒绝采样算法的低效率。
> 
> Gibbs采样算法：贝叶斯网络的Gibbs采样算法从任意的状态出发，通过(给定马尔可夫覆盖)对一个非证据变量Xi随机采样而生成下一个状态。对Xi的采样条件依赖于Xi的马尔可夫覆盖中的变量的当前值。
> 
> ![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/5e501a7fe765.png)

* * *

### ⚠作业题

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/321ea589e84d.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/4ec094a5452a.png)

![](/images/posts/电子科技大学人工智能期末复习笔记（四）：概率与贝叶斯网络/54f7aea762ed.png)
