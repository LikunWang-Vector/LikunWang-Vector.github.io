---
title: "40. å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°èŠ‚çš„VIPéŸ³ä¹è§£æç³»ç»Ÿçš„å…¨é¢å‡çº§ï¼ˆé™„æºç ï¼‰"
date: 2023-03-08
updated: 2023-03-08
categories:
  - Pythonçˆ¬è™«å…¥é—¨ã€è¿›é˜¶ä¸å®æˆ˜
tags:
  - ui
  - æ•°æ®åˆ†æ
  - tkinter
  - python
csdn_views: 1399
csdn_likes: 5
csdn_comments: 8
csdn_favorites: 20
csdn_url: https://blog.csdn.net/m0_59180666/article/details/129406958
cover: /images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/9af7a7c56491.png
lang_pair:
  en: "40. Practical: Music Parser with Tkinter GUI"
---

> æœ¬æ–‡è¿ç§»è‡ªCSDNåšå®¢
> åŸæ–‡é“¾æ¥ï¼š[40. å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°èŠ‚çš„VIPéŸ³ä¹è§£æç³»ç»Ÿçš„å…¨é¢å‡çº§ï¼ˆé™„æºç ï¼‰](https://blog.csdn.net/m0_59180666/article/details/129406958)
> ğŸ“Š 1399 é˜…è¯» | ğŸ‘ 5 ç‚¹èµ | ğŸ’¬ 8 è¯„è®º | â­ 20 æ”¶è—

**ç›®å½•**

å‰è¨€

ç›®çš„

æ€è·¯

ä»£ç å®ç°

1\. é¦–å…ˆè®¾è®¡ä¸»é¡µUIç•Œé¢

2\. å°è£…æ ¸å¿ƒè§£ææ­Œæ›²ä»£ç 

3\. ä¸‹è½½éŸ³ä¹åˆ°æœ¬åœ°

4\. å°†ç•Œé¢å±…ä¸­ï¼Œç¦æ­¢ä¿®æ”¹çª—å£å¤§å°ï¼Œç­‰å¾…å…³é—­/é€€å‡ºæŒ‡ä»¤ 

å®Œæ•´æºç 

è¿è¡Œæ•ˆæœ

ä½¿ç”¨è¿‡ç¨‹

èœå•æ 

æ‰“åŒ…çš„exe

æ€»ç»“

* * *

### å‰è¨€

æœ¬èŠ‚å°†å‡çº§[34\. å®æˆ˜ï¼šåŸºäºæŸapiå®ç°æ­Œæ›²æ£€ç´¢ä¸ä¸‹è½½ï¼ˆé™„å®Œæ•´æºä»£ç ï¼‰](https://blog.csdn.net/m0_59180666/article/details/128812483 "34. å®æˆ˜ï¼šåŸºäºæŸapiå®ç°æ­Œæ›²æ£€ç´¢ä¸ä¸‹è½½ï¼ˆé™„å®Œæ•´æºä»£ç ï¼‰")ï¼Œä¹Ÿå°†åŸºäºapiå®ç°[è§†é¢‘è§£æ](https://so.csdn.net/so/search?q=%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90&spm=1001.2101.3001.7020 "è§†é¢‘è§£æ")æ’­æ”¾çš„åŠŸèƒ½ï¼Œå¹¶ä¸”è¿˜å®ç°äº†ç”¨æˆ·UIç•Œé¢ï¼Œå¯ä»¥ç”¨pyinstallerç­‰åº“å¯¼å‡ºexeæ¥æ°¸ä¹…ä¿å­˜å¯æ‰§è¡Œæ–‡ä»¶ã€‚

åšä¸»å·²ç»æˆåŠŸå¯¼å‡ºå¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸Šä¸€èŠ‚çš„è§†é¢‘è§£æè½¯ä»¶ä¹Ÿå·²ç»å¯¼å‡ºã€‚éœ€è¦çš„å°ä¼™ä¼´å¯ä»¥ç§ä¿¡æˆ‘æˆ–è€…è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘åˆ†äº«ç»™ä½ ~

* * *

### ç›®çš„

å®ç°ä¸€ä¸ªVIPéŸ³ä¹è§£æç³»ç»Ÿï¼Œè¦æ±‚èƒ½å¤Ÿé€šè¿‡å…³é”®å­—æ£€ç´¢éœ€è¦çš„æ­Œæ›²ï¼Œå¹¶ä¸”è®¾è®¡ç”¨æˆ·ç•Œé¢ï¼Œè¿›è¡Œç›´è§‚çš„äº¤äº’è¡Œä¸ºï¼Œä¸‹è½½åˆ°æœ¬åœ°åŒç›®å½•ä¸‹çš„Downloadæ–‡ä»¶å¤¹ä¸­ã€‚

* * *

### æ€è·¯

ä½¿ç”¨tkinteråº“è®¾è®¡UIç•Œé¢å¹¶æŠŠå„ç»„ä»¶å°è£…èµ·æ¥ï¼Œæ ¸å¿ƒåŠŸèƒ½ä»ç„¶æ˜¯34èŠ‚æ‰€è®²è¿‡çš„ä»£ç éƒ¨åˆ†ï¼Œä¼ é€é—¨åœ¨è¿™é‡Œï¼Œæƒ³è¦äº†è§£æ ¸å¿ƒåŠŸèƒ½çš„è·³è½¬ï¼š[34\. å®æˆ˜ï¼šåŸºäºæŸapiå®ç°æ­Œæ›²æ£€ç´¢ä¸ä¸‹è½½ï¼ˆé™„å®Œæ•´æºä»£ç ï¼‰](https://blog.csdn.net/m0_59180666/article/details/128812483 "34. å®æˆ˜ï¼šåŸºäºæŸapiå®ç°æ­Œæ›²æ£€ç´¢ä¸ä¸‹è½½ï¼ˆé™„å®Œæ•´æºä»£ç ï¼‰")

æ¥ä¸‹æ¥æ˜¯è¯¦ç»†æ€è·¯ï¼š

1\. é¦–å…ˆè®¾è®¡ä¸»é¡µUIç•Œé¢

2\. å°è£…æ ¸å¿ƒè§£ææ­Œæ›²ä»£ç 

3\. ä¸‹è½½éŸ³ä¹åˆ°æœ¬åœ°

4\. å°†ç•Œé¢å±…ä¸­ï¼Œç¦æ­¢ä¿®æ”¹çª—å£å¤§å°ï¼Œç­‰å¾…å…³é—­/é€€å‡ºæŒ‡ä»¤ 

* * *

### ä»£ç å®ç°

**å…ˆå¯¼åŒ…**

> 
>     import os
>     import tkinter as tk
>     import webbrowser
>     import requests
>     import tkinter.messagebox as mes_box
>     import PySimpleGUI as sg
>     from tkinter import ttk
>     from retrying import retry

#### 1\. é¦–å…ˆè®¾è®¡ä¸»é¡µUIç•Œé¢

```python def __init__(self, weight=1000, height=600): self.ui_weight = weight self.ui_height = height self.title = "Vectorçš„éŸ³ä¹è§£æå™¨" self.ui_root = tk.Tk(className=self.title) self.ui_url = tk.StringVar() self.ui_var = tk.IntVar() self.ui_var.set(1) self.show_result = None self.song_num = None self.response_data = None self.song_url = None self.song_name = None self.song_author = None def set_ui(self): """ è®¾ç½®ç®€æ˜“UIç•Œé¢ :return: """ # Frameç©ºé—´ frame_1 = tk.Frame(self.ui_root) frame_2 = tk.Frame(self.ui_root) frame_3 = tk.Frame(self.ui_root) frame_4 = tk.Frame(self.ui_root) # uiç•Œé¢ä¸­èœå•è®¾è®¡ ui_menu = tk.Menu(self.ui_root) self.ui_root.config(menu=ui_menu) file_menu = tk.Menu(ui_menu, tearoff=0) ui_menu.add_cascade(label='èœå•', menu=file_menu) file_menu.add_command(label='ä½¿ç”¨è¯´æ˜', command=lambda: webbrowser.open('www.baidu.com')) file_menu.add_command(label='å…³äºä½œè€…', command=lambda: webbrowser.open( 'https://blog.csdn.net/m0_59180666?spm=1010.2135.3001.5343')) file_menu.add_command(label='é€€å‡º', command=self.ui_root.quit) # æ§ä»¶å†…å®¹è®¾ç½® choice_passageway = tk.Label(frame_1, text='è¯·é€‰æ‹©éŸ³ä¹æœç´¢é€šé“ï¼š', padx=10, pady=10) passageway_button_1 = tk.Radiobutton(frame_1, text='é…·æˆ‘', variable=self.ui_var, value=1, width=10, height=3) passageway_button_2 = tk.Radiobutton(frame_1, text='ç½‘æ˜“äº‘', variable=self.ui_var, value=2, width=10, height=3) passageway_button_3 = tk.Radiobutton(frame_1, text='QQéŸ³ä¹', variable=self.ui_var, value=3, width=10, height=3) passageway_button_4 = tk.Radiobutton(frame_1, text='é…·ç‹—', variable=self.ui_var, value=4, width=10, height=3) input_link = tk.Label(frame_2, text="è¯·è¾“å…¥æœç´¢å…³é”®è¯ï¼š") entry_style = tk.Entry(frame_2, textvariable=self.ui_url, highlightcolor='Fuchsia', highlightthickness=1, width=35) label2 = tk.Label(frame_2, text=" ") play_button = tk.Button(frame_2, text="æœç´¢", font=('æ¥·ä½“', 11), fg='Purple', width=2, height=1, command=self.get_KuWoMusic) label3 = tk.Label(frame_2, text=" ") # è¡¨æ ¼æ ·å¼ columns = ("åºå·", "æ­Œæ‰‹", "æ­Œæ›²", "ä¸“è¾‘") self.show_result = ttk.Treeview(frame_3, height=20, show="headings", columns=columns) # ä¸‹è½½ download_button = tk.Button(frame_4, text="ä¸‹è½½", font=('æ¥·ä½“', 11), fg='Purple', width=6, height=1, padx=5, pady=5, command=self.download_music) # æ§ä»¶å¸ƒå±€ frame_1.pack() frame_2.pack() frame_3.pack() frame_4.pack() choice_passageway.grid(row=0, column=0) passageway_button_1.grid(row=0, column=1) passageway_button_2.grid(row=0, column=2) passageway_button_3.grid(row=0, column=3) passageway_button_4.grid(row=0, column=4) input_link.grid(row=0, column=0) entry_style.grid(row=0, column=1) label2.grid(row=0, column=2) play_button.grid(row=0, column=3, ipadx=10, ipady=10) label3.grid(row=0, column=4) self.show_result.grid(row=0, column=4) download_button.grid(row=0, column=5) # è®¾ç½®è¡¨å¤´ self.show_result.heading("åºå·", text="åºå·") self.show_result.heading("æ­Œæ‰‹", text="æ­Œæ‰‹") self.show_result.heading("æ­Œæ›²", text="æ­Œæ›²") self.show_result.heading("ä¸“è¾‘", text="ä¸“è¾‘") # è®¾ç½®åˆ— self.show_result.column("åºå·", width=100, anchor='center') self.show_result.column("æ­Œæ‰‹", width=200, anchor='center') self.show_result.column("æ­Œæ›²", width=200, anchor='center') self.show_result.column("ä¸“è¾‘", width=300, anchor='center') # é¼ æ ‡ç‚¹å‡» self.show_result.bind('<ButtonRelease-1>', self.get_song_url) ``` 

#### 2\. å°è£…æ ¸å¿ƒè§£ææ­Œæ›²ä»£ç 

```python @retry(stop_max_attempt_number=5) def get_KuWoMusic(self): """ è·å–qqéŸ³ä¹ :return: """ # æ¸…ç©ºtreeviewè¡¨æ ¼æ•°æ® for item in self.show_result.get_children(): self.show_result.delete(item) headers = { 'accept': 'application/json, text/plain, */*', 'accept - encoding': 'gzip, deflate', 'accept - language': 'zh - CN, zh;q = 0.9', 'cache - control': 'no - cache', 'Connection': 'keep-alive', 'csrf': 'HH3GHIQ0RYM', 'Referer': 'http://www.kuwo.cn/search/list?key=%E5%91%A8%E6%9D%B0%E4%BC%A6', 'User-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ' 'Chrome/99.0.4844.51 Safari/537.36', 'Cookie': '_ga=GA1.2.218753071.1648798611; _gid=GA1.2.144187149.1648798611; _gat=1; ' 'Hm_lvt_cdb524f42f0ce19b169a8071123a4797=1648798611; ' 'Hm_lpvt_cdb524f42f0ce19b169a8071123a4797=1648798611; kw_token=HH3GHIQ0RYM' } search_input = self.ui_url.get() if len(search_input) > 0: search_url = 'http://www.kuwo.cn/api/www/search/searchMusicBykeyWord?' search_data = { 'key': search_input, 'pn': '1', 'rn': '80', 'httpsStatus': '1', 'reqId': '858597c1-b18e-11ec-83e4-9d53d2ff08ff' } try: self.response_data = requests.get(search_url, params=search_data, headers=headers, timeout=20).json() songs_data = self.response_data['data']['list'] if int(self.response_data['data']['total']) <= 0: mes_box.showerror(title='é”™è¯¯', message='æœç´¢: {} ä¸å­˜åœ¨.'.format(search_input)) else: for i in range(len(songs_data)): self.show_result.insert('', i, values=(i + 1, songs_data[i]['artist'], songs_data[i]['name'], songs_data[i]['album'])) except TimeoutError: mes_box.showerror(title='é”™è¯¯', message='æœç´¢è¶…æ—¶ï¼Œè¯·é‡æ–°è¾“å…¥åå†æœç´¢ï¼') else: mes_box.showerror(title='é”™è¯¯', message='æœªè¾“å…¥éœ€æŸ¥è¯¢çš„æ­Œæ›²æˆ–æ­Œæ‰‹ï¼Œè¯·è¾“å…¥åæœç´¢ï¼') def get_song_url(self, event): """ è·å–ä¸‹è½½æ­Œæ›²çš„åœ°å€ :return: """ # treeviewä¸­çš„å·¦é”®å•å‡» for item in self.show_result.selection(): item_text = self.show_result.item(item, "values") # è·å– self.song_num = int(item_text[0]) # è·å–ä¸‹è½½æ­Œæ›²çš„åœ°å€ if self.song_num is not None: songs_data = self.response_data['data']['list'] songs_req_id = self.response_data['reqId'] song_rid = songs_data[self.song_num - 1]['rid'] music_url = 'http://www.kuwo.cn/api/v1/www/music/playUrl?mid={}&type=convert_url3' \ '&httpsStatus=1&reqId={}' \ .format(song_rid, songs_req_id) response_data = requests.get(music_url).json() self.song_url = response_data['data'].get('url') self.song_name = songs_data[self.song_num - 1]['name'] self.song_author = songs_data[self.song_num - 1]['artist'] else: mes_box.showerror(title='é”™è¯¯', message='æœªé€‰æ‹©è¦ä¸‹è½½çš„æ­Œæ›²ï¼Œè¯·é€‰æ‹©') ``` 

#### 3\. ä¸‹è½½éŸ³ä¹åˆ°æœ¬åœ°

```python def download_music(self): """ ä¸‹è½½éŸ³ä¹ :return: """ if not os.path.exists('./Download'): os.mkdir("./Download/") if self.song_num is not None: song_name = self.song_name + '--' + self.song_author + ".mp3" try: save_path = os.path.join('./3_Download/{}'.format(song_name)) \ .replace('\\\', '/') true_path = os.path.abspath(save_path) resp = requests.get(self.song_url) with open(save_path, 'wb') as file: file.write(resp.content) mes_box.showinfo(title='ä¸‹è½½æˆåŠŸ', message='æ­Œæ›²ï¼š%s,ä¿å­˜åœ°å€ä¸º%s' % (self.song_name, true_path)) except Exception: mes_box.showerror(title='é”™è¯¯', message='æœªæ‰¾åˆ°å­˜æ”¾æ­Œæ›²çš„æ–‡ä»¶å¤¹') else: mes_box.showerror(title='é”™è¯¯', message='æœªé€‰æ‹©è¦ä¸‹è½½çš„æ­Œæ›²ï¼Œè¯·é€‰æ‹©åä¸‹è½½') def progress_bar(self, file_size): """ ä»»åŠ¡åŠ è½½è¿›åº¦æ¡ :return: """ layout = [[sg.Text('ä»»åŠ¡å®Œæˆè¿›åº¦')], [sg.ProgressBar(file_size, orientation='h', size=(40, 20), key='progressbar')], [sg.Cancel()]] # windowåªéœ€å°†è‡ªå®šä¹‰çš„å¸ƒå±€åŠ è½½å‡ºæ¥å³å¯ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çª—å£æ ‡é¢˜ã€‚ window = sg.Window('æœºå™¨äººæ‰§è¡Œè¿›åº¦', layout) # æ ¹æ®keyå€¼è·å–åˆ°è¿›åº¦æ¡ _progress_bar = window['progressbar'] for i in range(file_size): # å¾ªç¯ event, values = window.read(timeout=10) if event == 'Cancel' or event is None: break _progress_bar.UpdateBar(i + 1) ``` 

#### 4\. å°†ç•Œé¢å±…ä¸­ï¼Œç¦æ­¢ä¿®æ”¹çª—å£å¤§å°ï¼Œç­‰å¾…å…³é—­/é€€å‡ºæŒ‡ä»¤ 

```python def ui_center(self): """ UIç•Œé¢çª—å£è®¾ç½®ï¼šå±…ä¸­ """ ws = self.ui_root.winfo_screenwidth() hs = self.ui_root.winfo_screenheight() x = int((ws / 2) - (self.ui_weight / 2)) y = int((hs / 2) - (self.ui_height / 2)) self.ui_root.geometry('{}x{}+{}+{}'.format(self.ui_weight, self.ui_height, x, y)) def loop(self): """ å‡½æ•°è¯´æ˜:loopç­‰å¾…ç”¨æˆ·äº‹ä»¶ """ self.ui_root.resizable(False, False) # ç¦æ­¢ä¿®æ”¹çª—å£å¤§å° self.ui_center() # çª—å£å±…ä¸­ self.set_ui() self.ui_root.mainloop() if __name__ == '__main__': a = SetUI() a.loop() ``` 

* * *

### å®Œæ•´æºç 

```python # Created at UESTC # Author: Vector Kun # Time: 2023/1/29 11:07 import os import tkinter as tk import webbrowser import requests import tkinter.messagebox as mes_box import PySimpleGUI as sg from tkinter import ttk from retrying import retry class SetUI(object): """ éŸ³ä¹å¼¹æ¡†ç•Œé¢ """ def __init__(self, weight=1000, height=600): self.ui_weight = weight self.ui_height = height self.title = "Vectorçš„éŸ³ä¹è§£æå™¨" self.ui_root = tk.Tk(className=self.title) self.ui_url = tk.StringVar() self.ui_var = tk.IntVar() self.ui_var.set(1) self.show_result = None self.song_num = None self.response_data = None self.song_url = None self.song_name = None self.song_author = None def set_ui(self): """ è®¾ç½®ç®€æ˜“UIç•Œé¢ :return: """ # Frameç©ºé—´ frame_1 = tk.Frame(self.ui_root) frame_2 = tk.Frame(self.ui_root) frame_3 = tk.Frame(self.ui_root) frame_4 = tk.Frame(self.ui_root) # uiç•Œé¢ä¸­èœå•è®¾è®¡ ui_menu = tk.Menu(self.ui_root) self.ui_root.config(menu=ui_menu) file_menu = tk.Menu(ui_menu, tearoff=0) ui_menu.add_cascade(label='èœå•', menu=file_menu) file_menu.add_command(label='ä½¿ç”¨è¯´æ˜', command=lambda: webbrowser.open('www.baidu.com')) file_menu.add_command(label='å…³äºä½œè€…', command=lambda: webbrowser.open( 'https://blog.csdn.net/m0_59180666?spm=1010.2135.3001.5343')) file_menu.add_command(label='é€€å‡º', command=self.ui_root.quit) # æ§ä»¶å†…å®¹è®¾ç½® choice_passageway = tk.Label(frame_1, text='è¯·é€‰æ‹©éŸ³ä¹æœç´¢é€šé“ï¼š', padx=10, pady=10) passageway_button_1 = tk.Radiobutton(frame_1, text='é…·æˆ‘', variable=self.ui_var, value=1, width=10, height=3) passageway_button_2 = tk.Radiobutton(frame_1, text='ç½‘æ˜“äº‘', variable=self.ui_var, value=2, width=10, height=3) passageway_button_3 = tk.Radiobutton(frame_1, text='QQéŸ³ä¹', variable=self.ui_var, value=3, width=10, height=3) passageway_button_4 = tk.Radiobutton(frame_1, text='é…·ç‹—', variable=self.ui_var, value=4, width=10, height=3) input_link = tk.Label(frame_2, text="è¯·è¾“å…¥æœç´¢å…³é”®è¯ï¼š") entry_style = tk.Entry(frame_2, textvariable=self.ui_url, highlightcolor='Fuchsia', highlightthickness=1, width=35) label2 = tk.Label(frame_2, text=" ") play_button = tk.Button(frame_2, text="æœç´¢", font=('æ¥·ä½“', 11), fg='Purple', width=2, height=1, command=self.get_KuWoMusic) label3 = tk.Label(frame_2, text=" ") # è¡¨æ ¼æ ·å¼ columns = ("åºå·", "æ­Œæ‰‹", "æ­Œæ›²", "ä¸“è¾‘") self.show_result = ttk.Treeview(frame_3, height=20, show="headings", columns=columns) # ä¸‹è½½ download_button = tk.Button(frame_4, text="ä¸‹è½½", font=('æ¥·ä½“', 11), fg='Purple', width=6, height=1, padx=5, pady=5, command=self.download_music) # æ§ä»¶å¸ƒå±€ frame_1.pack() frame_2.pack() frame_3.pack() frame_4.pack() choice_passageway.grid(row=0, column=0) passageway_button_1.grid(row=0, column=1) passageway_button_2.grid(row=0, column=2) passageway_button_3.grid(row=0, column=3) passageway_button_4.grid(row=0, column=4) input_link.grid(row=0, column=0) entry_style.grid(row=0, column=1) label2.grid(row=0, column=2) play_button.grid(row=0, column=3, ipadx=10, ipady=10) label3.grid(row=0, column=4) self.show_result.grid(row=0, column=4) download_button.grid(row=0, column=5) # è®¾ç½®è¡¨å¤´ self.show_result.heading("åºå·", text="åºå·") self.show_result.heading("æ­Œæ‰‹", text="æ­Œæ‰‹") self.show_result.heading("æ­Œæ›²", text="æ­Œæ›²") self.show_result.heading("ä¸“è¾‘", text="ä¸“è¾‘") # è®¾ç½®åˆ— self.show_result.column("åºå·", width=100, anchor='center') self.show_result.column("æ­Œæ‰‹", width=200, anchor='center') self.show_result.column("æ­Œæ›²", width=200, anchor='center') self.show_result.column("ä¸“è¾‘", width=300, anchor='center') # é¼ æ ‡ç‚¹å‡» self.show_result.bind('<ButtonRelease-1>', self.get_song_url) @retry(stop_max_attempt_number=5) def get_KuWoMusic(self): """ è·å–qqéŸ³ä¹ :return: """ # æ¸…ç©ºtreeviewè¡¨æ ¼æ•°æ® for item in self.show_result.get_children(): self.show_result.delete(item) headers = { 'accept': 'application/json, text/plain, */*', 'accept - encoding': 'gzip, deflate', 'accept - language': 'zh - CN, zh;q = 0.9', 'cache - control': 'no - cache', 'Connection': 'keep-alive', 'csrf': 'HH3GHIQ0RYM', 'Referer': 'http://www.kuwo.cn/search/list?key=%E5%91%A8%E6%9D%B0%E4%BC%A6', 'User-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ' 'Chrome/99.0.4844.51 Safari/537.36', 'Cookie': '_ga=GA1.2.218753071.1648798611; _gid=GA1.2.144187149.1648798611; _gat=1; ' 'Hm_lvt_cdb524f42f0ce19b169a8071123a4797=1648798611; ' 'Hm_lpvt_cdb524f42f0ce19b169a8071123a4797=1648798611; kw_token=HH3GHIQ0RYM' } search_input = self.ui_url.get() if len(search_input) > 0: search_url = 'http://www.kuwo.cn/api/www/search/searchMusicBykeyWord?' search_data = { 'key': search_input, 'pn': '1', 'rn': '80', 'httpsStatus': '1', 'reqId': '858597c1-b18e-11ec-83e4-9d53d2ff08ff' } try: self.response_data = requests.get(search_url, params=search_data, headers=headers, timeout=20).json() songs_data = self.response_data['data']['list'] if int(self.response_data['data']['total']) <= 0: mes_box.showerror(title='é”™è¯¯', message='æœç´¢: {} ä¸å­˜åœ¨.'.format(search_input)) else: for i in range(len(songs_data)): self.show_result.insert('', i, values=(i + 1, songs_data[i]['artist'], songs_data[i]['name'], songs_data[i]['album'])) except TimeoutError: mes_box.showerror(title='é”™è¯¯', message='æœç´¢è¶…æ—¶ï¼Œè¯·é‡æ–°è¾“å…¥åå†æœç´¢ï¼') else: mes_box.showerror(title='é”™è¯¯', message='æœªè¾“å…¥éœ€æŸ¥è¯¢çš„æ­Œæ›²æˆ–æ­Œæ‰‹ï¼Œè¯·è¾“å…¥åæœç´¢ï¼') def get_song_url(self, event): """ è·å–ä¸‹è½½æ­Œæ›²çš„åœ°å€ :return: """ # treeviewä¸­çš„å·¦é”®å•å‡» for item in self.show_result.selection(): item_text = self.show_result.item(item, "values") # è·å– self.song_num = int(item_text[0]) # è·å–ä¸‹è½½æ­Œæ›²çš„åœ°å€ if self.song_num is not None: songs_data = self.response_data['data']['list'] songs_req_id = self.response_data['reqId'] song_rid = songs_data[self.song_num - 1]['rid'] music_url = 'http://www.kuwo.cn/api/v1/www/music/playUrl?mid={}&type=convert_url3' \ '&httpsStatus=1&reqId={}' \ .format(song_rid, songs_req_id) response_data = requests.get(music_url).json() self.song_url = response_data['data'].get('url') self.song_name = songs_data[self.song_num - 1]['name'] self.song_author = songs_data[self.song_num - 1]['artist'] else: mes_box.showerror(title='é”™è¯¯', message='æœªé€‰æ‹©è¦ä¸‹è½½çš„æ­Œæ›²ï¼Œè¯·é€‰æ‹©') def download_music(self): """ ä¸‹è½½éŸ³ä¹ :return: """ if not os.path.exists('./Download'): os.mkdir("./Download/") if self.song_num is not None: song_name = self.song_name + '--' + self.song_author + ".mp3" try: save_path = os.path.join('./3_Download/{}'.format(song_name)) \ .replace('\\\', '/') true_path = os.path.abspath(save_path) resp = requests.get(self.song_url) with open(save_path, 'wb') as file: file.write(resp.content) mes_box.showinfo(title='ä¸‹è½½æˆåŠŸ', message='æ­Œæ›²ï¼š%s,ä¿å­˜åœ°å€ä¸º%s' % (self.song_name, true_path)) except Exception: mes_box.showerror(title='é”™è¯¯', message='æœªæ‰¾åˆ°å­˜æ”¾æ­Œæ›²çš„æ–‡ä»¶å¤¹') else: mes_box.showerror(title='é”™è¯¯', message='æœªé€‰æ‹©è¦ä¸‹è½½çš„æ­Œæ›²ï¼Œè¯·é€‰æ‹©åä¸‹è½½') def progress_bar(self, file_size): """ ä»»åŠ¡åŠ è½½è¿›åº¦æ¡ :return: """ layout = [[sg.Text('ä»»åŠ¡å®Œæˆè¿›åº¦')], [sg.ProgressBar(file_size, orientation='h', size=(40, 20), key='progressbar')], [sg.Cancel()]] # windowåªéœ€å°†è‡ªå®šä¹‰çš„å¸ƒå±€åŠ è½½å‡ºæ¥å³å¯ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çª—å£æ ‡é¢˜ã€‚ window = sg.Window('æœºå™¨äººæ‰§è¡Œè¿›åº¦', layout) # æ ¹æ®keyå€¼è·å–åˆ°è¿›åº¦æ¡ _progress_bar = window['progressbar'] for i in range(file_size): # å¾ªç¯ event, values = window.read(timeout=10) if event == 'Cancel' or event is None: break _progress_bar.UpdateBar(i + 1) def ui_center(self): """ UIç•Œé¢çª—å£è®¾ç½®ï¼šå±…ä¸­ """ ws = self.ui_root.winfo_screenwidth() hs = self.ui_root.winfo_screenheight() x = int((ws / 2) - (self.ui_weight / 2)) y = int((hs / 2) - (self.ui_height / 2)) self.ui_root.geometry('{}x{}+{}+{}'.format(self.ui_weight, self.ui_height, x, y)) def loop(self): """ å‡½æ•°è¯´æ˜:loopç­‰å¾…ç”¨æˆ·äº‹ä»¶ """ self.ui_root.resizable(False, False) # ç¦æ­¢ä¿®æ”¹çª—å£å¤§å° self.ui_center() # çª—å£å±…ä¸­ self.set_ui() self.ui_root.mainloop() if __name__ == '__main__': a = SetUI() a.loop() ``` 

* * *

### è¿è¡Œæ•ˆæœ

#### ä½¿ç”¨è¿‡ç¨‹

![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/9af7a7c56491.png)

#### ![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/9d308dc2dd58.png)![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/ad9bdd89425d.png)![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/788177e5cca2.png)![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/f702c18a6358.png)

#### èœå•æ 

![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/4aa01dd37e53.png)

#### æ‰“åŒ…çš„exe

![](/images/posts/40.-å®æˆ˜ï¼šåŸºäºtkinterå®ç°ç”¨æˆ·UIç•Œé¢â€”â€”å¯¹34å°/8c02234ceaae.png)

* * *

### æ€»ç»“

æœ¬æ–‡å®ç°äº†ä¸€ä¸ªVIPéŸ³ä¹è§£æç³»ç»Ÿï¼Œèƒ½å¤Ÿé€šè¿‡å…³é”®å­—æ£€ç´¢éœ€è¦çš„æ­Œæ›²ï¼Œå¹¶ä¸”è®¾è®¡äº†ç”¨æˆ·ç•Œé¢ï¼Œå¯ä»¥è¿›è¡Œç›´è§‚çš„äº¤äº’è¡Œä¸ºï¼Œä¹Ÿèƒ½å°†ç›®æ ‡æ­Œæ›²ä¸‹è½½åˆ°æœ¬åœ°åŒç›®å½•ä¸‹çš„Downloadæ–‡ä»¶å¤¹ä¸­ã€‚
